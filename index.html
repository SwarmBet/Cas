<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SwarmBet - Star Premium 2026</title>
    <style>
        :root { 
            --orange: #ff9900; 
            --dark: #0a0a0a; 
            --panel: #151515; 
            --green: #27ae60; 
            --red: #e74c3c; 
            --black: #2c3e50; 
            --gold: #f1c40f;
            --sidebar: #111111;
        }
        body { 
            background-color: var(--dark); 
            color: white; 
            font-family: 'Inter', 'Segoe UI', sans-serif; 
            margin: 0; 
            display: flex; 
            height: 100vh; 
            overflow: hidden;
            background-image: radial-gradient(circle at center, rgba(255, 153, 0, 0.03) 0%, transparent 80%);
        }

        /* Sidebar & Layout */
        .sidebar {
            width: 240px;
            background: var(--sidebar);
            border-right: 1px solid #222;
            display: flex;
            flex-direction: column;
            padding: 20px 0;
            flex-shrink: 0;
        }
        .logo { padding: 0 25px 30px; font-size: 24px; font-weight: 900; color: white; text-decoration: none; }
        .logo span { color: var(--orange); }

        .nav-item {
            padding: 12px 25px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: 0.2s;
            color: #888;
        }
        .nav-item:hover, .nav-item.active {
            background: rgba(255, 153, 0, 0.1);
            color: var(--orange);
            border-left: 3px solid var(--orange);
        }

        .main-wrapper { flex: 1; display: flex; flex-direction: column; overflow-y: auto; }
        .top-nav {
            height: 70px;
            background: #000;
            border-bottom: 2px solid var(--orange);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 0 40px;
            gap: 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .balance-box {
            background: #1a1a1a;
            padding: 8px 18px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid #333;
        }

        .container { padding: 40px; max-width: 1100px; margin: 0 auto; width: 100%; box-sizing: border-box; }
        .card { background: var(--panel); border: 1px solid #222; border-radius: 15px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        .hidden { display: none !important; }
        .btn-play { background: var(--orange); color: black; border: none; padding: 12px 20px; border-radius: 8px; font-weight: 900; cursor: pointer; }
        .btn-back { background: #333; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-bottom: 20px; font-weight: bold; }
        input, select { background: #000; border: 1px solid #333; color: var(--orange); padding: 10px; border-radius: 8px; text-align: center; outline: none; }

        /* Roulette Specific UI */
        .r-slider-wrap { position: relative; width: 100%; height: 80px; background: #111; border: 2px solid #333; overflow: hidden; border-radius: 10px; margin-bottom: 20px; }
        .r-slider-inner { display: flex; position: absolute; left: 0; align-items: center; height: 100%; will-change: transform; }
        .r-num { min-width: 80px; width: 80px; height: 80px; display: flex; align-items: center; justify-content: center; font-weight: bold; border-right: 1px solid rgba(0,0,0,0.5); font-size: 24px; }
        .r-pointer { position: absolute; left: 50%; top: 0; bottom: 0; width: 4px; background: var(--orange); z-index: 10; transform: translateX(-50%); box-shadow: 0 0 15px var(--orange); }
        
        .r-grid { display: grid; grid-template-columns: 80px repeat(12, 1fr); gap: 5px; }
        .cell { position: relative; height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; border-radius: 4px; border: 2px solid transparent; font-size: 12px; }
        .cell.nula { background: var(--green); grid-row: span 3; height: 160px; font-size: 24px; }
        .cell.red { background: var(--red); }
        .cell.black { background: var(--black); }
        .cell.active { border-color: white !important; box-shadow: 0 0 12px #fff; }

        .btn-extra { 
            position: relative; 
            background: #222; 
            border: 1px solid #444; 
            color: white; 
            padding: 10px; 
            cursor: pointer; 
            font-weight: bold; 
            border-radius: 4px; 
            overflow: visible; 
        }

        .chip-overlay { 
            position: absolute; 
            width: 22px; 
            height: 22px; 
            background: var(--orange); 
            border-radius: 50%; 
            border: 2px dashed white; 
            color: black; 
            font-size: 9px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-weight: bold; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            z-index: 10; 
            pointer-events: none;
        }

        /* Ostatn√≠ styly... (zkr√°ceno pro p≈ôehlednost, v souboru z≈Øst√°vaj√≠) */
        .m-grid { display: grid; grid-template-columns: repeat(5, 60px); gap: 10px; justify-content: center; margin-top: 20px; }
        .tile { width: 60px; height: 60px; background: #000; border: 1px solid #333; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 28px; }
        .win-announcement { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 9999; text-align: center; pointer-events: none; animation: winPop 3s forwards; }
        @keyframes winPop { 0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 15% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); } 100% { opacity: 0; transform: translate(-50%, -70%) scale(0.8); } }
    </style>
</head>
<body onclick="initAudio()">

<div id="auth-screen" style="display:flex; justify-content:center; align-items:center; width: 100vw; height: 100vh; background: var(--dark); position:fixed; z-index: 1000;">
    <div class="card" style="width: 320px; text-align: center; border: 2px solid var(--orange);">
        <h1 style="color:var(--orange); margin:0;">SWARMBET</h1>
        <p style="color:#555; font-size:12px; margin-bottom:20px;">EST. 2026</p>
        <input type="text" id="user" placeholder="Username" style="width:80%; margin-bottom:10px;"><br>
        <input type="password" id="pass" placeholder="Password" style="width:80%; margin-bottom:20px;"><br>
        <button class="btn-play" onclick="auth('login')" style="width:100%; margin-bottom:10px;">LOGIN</button>
        <button class="btn-play" onclick="auth('reg')" style="width:100%; background:#222; color:white;">REGISTER</button>
    </div>
</div>

<div id="main-app" class="hidden" style="display: flex; width: 100%;">
    <div class="sidebar">
        <div class="logo">S<span>B</span></div>
        <div class="nav-item active" id="nav-games" onclick="showPage('games')">üéÆ Games</div>
        <div class="nav-item" id="nav-history" onclick="showPage('history')">üìú Bet History</div>
        <div class="nav-item" id="nav-rakeback" onclick="showPage('rakeback')">üéÅ Promo Codes</div>
        <div id="link-admin" class="nav-item hidden" onclick="showPage('admin')">‚öôÔ∏è Admin Panel</div>
        <div style="margin-top: auto;">
            <div class="nav-item" onclick="logout()">üö™ Logout</div>
        </div>
    </div>

    <div class="main-wrapper">
        <div class="top-nav">
            <div class="balance-box">
                <span style="color:var(--orange)">‚≠ê</span>
                <span id="display-chips">0</span>
            </div>
            <div style="font-weight: 900; color: var(--orange);" id="display-name">---</div>
        </div>

        <div class="container">
            <div id="page-games">
                <div id="selection-menu">
                    <div class="section-title">ALL GAMES</div>
                    <div class="games-grid">
                        <div class="game-card" onclick="selectGame('mines')">
                            <div class="icon-box" style="color:#e91e63;">üí£</div>
                            <h3>Mines</h3>
                            <button class="btn-card-play">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('roulette')">
                            <div class="icon-box" style="color:#1abc9c;">üîò</div>
                            <h3>Roulette</h3>
                            <button class="btn-card-play">Play</button>
                        </div>
                    </div>
                </div>

                <div id="game-active-page" class="hidden">
                    <button class="btn-back" onclick="backToMenu()">‚Üê BACK TO MENU</button>
                    <div class="card" style="background:#0c0c0c;">
                        <div id="game-roulette" class="hidden">
                            <h2 style="color:#1abc9c; text-align:center;">ROULETTE</h2>
                            <div id="r-status" style="text-align:center; color:var(--orange); font-weight:bold; margin-bottom:10px; height:20px;">PLACE YOUR BETS</div>
                            
                            <div class="r-slider-wrap" id="r-wrap">
                                <div class="r-pointer"></div>
                                <div id="r-slider" class="r-slider-inner"></div>
                            </div>

                            <div class="r-grid" id="r-board"></div>

                            <div class="r-dozen-bets" style="display:grid; grid-template-columns: repeat(3, 1fr); gap:5px; margin-top:5px; margin-left:85px;">
                                <button class="btn-extra" onclick="setExtraBet('1st12', this)">1st 12 (3x)</button>
                                <button class="btn-extra" onclick="setExtraBet('2nd12', this)">2nd 12 (3x)</button>
                                <button class="btn-extra" onclick="setExtraBet('3rd12', this)">3rd 12 (3x)</button>
                            </div>

                            <div class="r-extra-bets" style="display:grid; grid-template-columns: repeat(6, 1fr); gap:5px; margin-top:10px; margin-left:85px;">
                                <button class="btn-extra" onclick="setExtraBet('1-18', this)">1 - 18</button>
                                <button class="btn-extra" onclick="setExtraBet('even', this)">EVEN</button>
                                <button class="btn-extra" style="background:var(--red); border:none;" onclick="setExtraBet('red', this)">RED</button>
                                <button class="btn-extra" style="background:var(--black); border:none;" onclick="setExtraBet('black', this)">BLACK</button>
                                <button class="btn-extra" onclick="setExtraBet('odd', this)">ODD</button>
                                <button class="btn-extra" onclick="setExtraBet('19-36', this)">19 - 36</button>
                            </div>

                            <div style="display:flex; gap:10px; margin-top:20px; justify-content:center; align-items:center;">
                                BET PER CELL: <input type="number" id="r-bet" value="50">
                                <button class="btn-play" id="r-spin" onclick="spinRoulette()">SPIN</button>
                                <button class="btn-play" style="background:#444; color:white;" onclick="clearRouletteBets()">CLEAR</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="win-container"></div>

<script>
    const DB_URL = "https://casbss-c75a0-default-rtdb.europe-west1.firebasedatabase.app/users";
    let currentUser = localStorage.getItem('swarm_user');
    let userData = null;
    let rBets = {};

    // --- AUTH & UI ---
    async function auth(type) {
        const u = document.getElementById('user').value.trim(), p = document.getElementById('pass').value;
        if(!u || !p) return;
        const res = await fetch(DB_URL + ".json"), users = await res.json() || {};
        if(type === 'reg') {
            if(users[u]) return alert("Taken!");
            userData = { password: p, chips: 500 };
            await fetch(`${DB_URL}/${u}.json`, { method: 'PUT', body: JSON.stringify(userData) });
            alert("Registered!");
        } else {
            if(users[u] && users[u].password === p) {
                currentUser = u; userData = users[u];
                localStorage.setItem('swarm_user', u);
                loginSuccess();
            } else alert("Fail!");
        }
    }

    function loginSuccess() {
        document.getElementById('auth-screen').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
        document.getElementById('display-name').innerText = currentUser;
        buildRoulette();
        updateUI();
    }

    function updateUI() {
        if(!userData) return;
        document.getElementById('display-chips').innerText = Math.floor(userData.chips);
        fetch(`${DB_URL}/${currentUser}.json`, { method: 'PUT', body: JSON.stringify(userData) });
    }

    function selectGame(g) {
        document.getElementById('selection-menu').classList.add('hidden');
        document.getElementById('game-active-page').classList.remove('hidden');
        document.getElementById('game-roulette').classList.remove('hidden');
    }

    function backToMenu() {
        document.getElementById('selection-menu').classList.remove('hidden');
        document.getElementById('game-active-page').classList.add('hidden');
    }

    // --- ROULETTE LOGIC ---
    const rOrder = [0,32,15,19,4,21,2,25,17,34,6,27,13,36,11,30,8,23,10,5,24,16,33,1,20,14,31,9,22,18,29,7,28,12,35,3,26];
    const redNums = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];

    function buildRoulette() {
        const board = document.getElementById('r-board');
        board.innerHTML = '<div class="cell nula" onclick="setRouletteBet(0, this)">0</div>';
        for(let i=1; i<=36; i++) {
            const isRed = redNums.includes(i);
            const div = document.createElement('div');
            div.className = `cell ${isRed?'red':'black'}`;
            div.innerText = i;
            div.onclick = () => setRouletteBet(i, div);
            board.appendChild(div);
        }
        const slider = document.getElementById('r-slider');
        for(let i=0; i<80; i++) {
            const n = rOrder[i % rOrder.length];
            const div = document.createElement('div');
            div.className = 'r-num';
            div.style.background = n===0 ? 'var(--green)' : (redNums.includes(n)?'var(--red)':'var(--black)');
            div.innerText = n;
            slider.appendChild(div);
        }
    }

    function setRouletteBet(num, el) {
        let amt = parseInt(document.getElementById('r-bet').value);
        if(amt > userData.chips || amt <= 0) return;
        userData.chips -= amt;
        rBets[num] = (rBets[num]||0) + amt;
        let chip = el.querySelector('.chip-overlay');
        if(!chip) {
            chip = document.createElement('div');
            chip.className = 'chip-overlay';
            el.appendChild(chip);
        }
        chip.innerText = rBets[num];
        updateUI();
    }

    function setExtraBet(type, el) {
        let amt = parseInt(document.getElementById('r-bet').value);
        if(amt > userData.chips || amt <= 0) return;
        
        userData.chips -= amt;
        rBets[type] = (rBets[type]||0) + amt;
        
        // OPRAVA: ≈Ωeton se nyn√≠ vlo≈æ√≠ p≈ô√≠mo do tlaƒç√≠tka a vycentruje
        let chip = el.querySelector('.chip-overlay');
        if(!chip) {
            chip = document.createElement('div');
            chip.className = 'chip-overlay';
            el.appendChild(chip);
        }
        
        chip.innerText = rBets[type];
        updateUI();
    }

    function clearRouletteBets() {
        for(let key in rBets) userData.chips += rBets[key];
        rBets = {};
        document.querySelectorAll('.chip-overlay').forEach(c => c.remove());
        updateUI();
    }

    function spinRoulette() {
        if(Object.keys(rBets).length === 0) return;
        const btn = document.getElementById('r-spin');
        btn.disabled = true;
        const slider = document.getElementById('r-slider');
        const winIdx = Math.floor(Math.random()*rOrder.length);
        const winNum = rOrder[winIdx];
        const offset = (winIdx + 37*2) * 80;
        
        slider.style.transition = 'none';
        slider.style.transform = 'translateX(0)';
        setTimeout(() => {
            slider.style.transition = 'transform 4s cubic-bezier(0.1, 0, 0.1, 1)';
            slider.style.transform = `translateX(-${offset}px)`;
        }, 50);

        setTimeout(() => {
            let totalWin = 0;
            // V√Ωpoƒçet v√Ωher...
            if(rBets[winNum]) totalWin += rBets[winNum] * 36;
            if(winNum !== 0) {
                if(rBets['red'] && redNums.includes(winNum)) totalWin += rBets['red']*2;
                if(rBets['black'] && !redNums.includes(winNum)) totalWin += rBets['black']*2;
                if(rBets['even'] && winNum%2===0) totalWin += rBets['even']*2;
                if(rBets['odd'] && winNum%2!==0) totalWin += rBets['odd']*2;
            }
            
            userData.chips += totalWin;
            rBets = {};
            document.querySelectorAll('.chip-overlay').forEach(c => c.remove());
            updateUI();
            btn.disabled = false;
            document.getElementById('r-status').innerText = `RESULT: ${winNum}`;
        }, 4100);
    }

    function initAudio() {} 
</script>
</body>
</html>
