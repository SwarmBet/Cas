<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>SwarmBet - Star Premium 2026 (900+ Edition)</title>
    <style>
        :root { 
            --orange: #ff9900; --dark: #0a0a0a; --panel: #151515; --green: #27ae60; 
            --red: #e74c3c; --black: #2c3e50; --gold: #f1c40f; --sidebar: #111111;
            --blue: #3498db; --purple: #9b59b6;
        }
        body { 
            background-color: var(--dark); color: white; font-family: 'Inter', sans-serif; 
            margin: 0; display: flex; height: 100vh; overflow: hidden;
            background-image: radial-gradient(circle at center, rgba(255, 153, 0, 0.03) 0%, transparent 80%);
        }

        /* SIDEBAR A STRUKTURA */
        .sidebar { width: 260px; background: var(--sidebar); border-right: 1px solid #222; display: flex; flex-direction: column; padding: 25px 0; flex-shrink: 0; z-index: 1000; }
        .logo { padding: 0 30px 40px; font-size: 28px; font-weight: 900; color: white; letter-spacing: 2px; }
        .logo span { color: var(--orange); }
        .nav-item { padding: 15px 30px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 15px; transition: 0.3s; color: #777; border-left: 4px solid transparent; }
        .nav-item:hover, .nav-item.active { background: linear-gradient(90deg, rgba(255, 153, 0, 0.1) 0%, transparent 100%); color: var(--orange); border-left: 4px solid var(--orange); }
        .sidebar-footer { margin-top: auto; padding: 20px; border-top: 1px solid #222; }

        .main-wrapper { flex: 1; display: flex; flex-direction: column; overflow-y: auto; background: #0c0c0c; position: relative; }
        .top-nav { height: 80px; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); border-bottom: 2px solid var(--orange); display: flex; align-items: center; justify-content: flex-end; padding: 0 50px; gap: 25px; position: sticky; top: 0; z-index: 900; }
        .balance-box { background: #1a1a1a; padding: 10px 22px; border-radius: 12px; color: white; font-weight: 800; display: flex; align-items: center; gap: 12px; border: 1px solid #333; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }

        .container { padding: 50px; max-width: 1500px; margin: 0 auto; width: 100%; box-sizing: border-box; }

        /* SYMETRICK√â MENU - 10 HER */
        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px; }
        .game-card { 
            background: #111; border-radius: 24px; padding: 50px 25px; text-align: center; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            cursor: pointer; border: 1px solid #222; position: relative; overflow: hidden;
        }
        .game-card::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(180deg, transparent 0%, rgba(255,153,0,0.05) 100%); opacity: 0; transition: 0.3s; }
        .game-card:hover { transform: translateY(-12px); border-color: var(--orange); box-shadow: 0 15px 40px rgba(0,0,0,0.6); }
        .game-card:hover::before { opacity: 1; }
        
        /* VELK√â IKONY */
        .icon-box { 
            width: 120px; height: 120px; background: rgba(255, 153, 0, 0.07); border-radius: 30px; 
            margin: 0 auto 25px; display: flex; align-items: center; justify-content: center; 
            font-size: 60px; border: 1px solid rgba(255, 153, 0, 0.15); transition: 0.3s;
        }
        .game-card:hover .icon-box { transform: scale(1.1) rotate(5deg); background: rgba(255, 153, 0, 0.15); }

        /* UNIVERZ√ÅLN√ç KOMPONENTY */
        .btn-play { background: var(--orange); color: black; border: none; padding: 16px 35px; border-radius: 12px; font-weight: 900; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; transition: 0.2s; }
        .btn-play:hover { transform: scale(1.05); filter: brightness(1.1); }
        .btn-play:disabled { background: #333; color: #666; cursor: not-allowed; transform: none; }
        .btn-back { background: transparent; color: #666; border: 1px solid #333; padding: 10px 20px; border-radius: 10px; cursor: pointer; margin-bottom: 30px; font-weight: bold; transition: 0.2s; }
        .btn-back:hover { color: white; border-color: white; }
        
        input { background: #050505; border: 1px solid #333; color: var(--orange); padding: 14px; border-radius: 10px; text-align: center; font-weight: bold; font-size: 16px; width: 150px; outline: none; transition: 0.3s; }
        input:focus { border-color: var(--orange); box-shadow: 0 0 10px rgba(255,153,0,0.2); }

        /* GRAFIKA MINES */
        .m-grid { display: grid; grid-template-columns: repeat(5, 70px); gap: 12px; justify-content: center; margin: 30px auto; }
        .tile { width: 70px; height: 70px; background: #000; border: 1px solid #333; border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 35px; transition: 0.2s; }
        .tile:hover { border-color: var(--orange); background: #111; }
        .tile.revealed { background: #1a1a1a; cursor: default; }

        /* RULETA - KOMPLETN√ç VIZU√ÅL */
        .r-slider-wrap { position: relative; width: 100%; height: 90px; background: #0a0a0a; border: 2px solid #222; overflow: hidden; border-radius: 15px; margin-bottom: 30px; }
        .r-slider-inner { display: flex; position: absolute; left: 0; align-items: center; height: 100%; transition: transform 5s cubic-bezier(0.1, 0, 0.1, 1); }
        .r-num { min-width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; font-weight: 900; font-size: 28px; border-right: 1px solid rgba(0,0,0,0.5); }
        .r-grid { display: grid; grid-template-columns: 80px repeat(12, 1fr); gap: 5px; max-width: 1000px; margin: 20px auto; }
        .cell { height: 60px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; border-radius: 8px; position: relative; transition: 0.2s; border: 1px solid rgba(255,255,255,0.05); }
        .cell:hover { filter: brightness(1.3); transform: scale(1.02); }
        .cell.nula { background: var(--green); grid-row: span 3; height: 190px; font-size: 30px; }
        .cell.active { border: 2px solid white; box-shadow: 0 0 15px white; z-index: 2; }
        .chip-overlay { position: absolute; width: 28px; height: 28px; background: var(--orange); border: 2px solid white; border-radius: 50%; color: black; font-size: 10px; display: flex; align-items: center; justify-content: center; font-weight: 900; z-index: 10; pointer-events: none; }

        /* BLACKJACK / BACCARAT KARTY */
        .card-ui { 
            width: 90px; height: 130px; background: white; border-radius: 12px; color: black; 
            display: flex; flex-direction: column; justify-content: space-between; padding: 10px;
            font-weight: 900; font-size: 24px; box-shadow: 0 8px 20px rgba(0,0,0,0.5); 
            animation: cardDeal 0.5s ease-out;
        }
        @keyframes cardDeal { from { transform: translateY(-100px) rotate(20deg); opacity: 0; } to { transform: translateY(0) rotate(0); opacity: 1; } }
        .card-ui.red { color: var(--red); }
        .hand-label { font-size: 14px; color: #666; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 2px; }

        /* CRASH ANIMACE */
        #crash-display { font-size: 120px; font-weight: 900; font-variant-numeric: tabular-nums; text-shadow: 0 0 30px rgba(255,153,0,0.3); }

        /* WIN OVERLAY */
        .win-announcement { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            z-index: 9999; text-align: center; pointer-events: none; 
        }
        .win-inner { animation: winBig 3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes winBig {
            0% { opacity: 0; scale: 0; transform: rotate(-20deg); }
            15% { opacity: 1; scale: 1.2; transform: rotate(0); }
            85% { opacity: 1; scale: 1; }
            100% { opacity: 0; scale: 0.8; transform: translateY(-100px); }
        }

        /* TOWER */
        .tower-row { display: flex; gap: 10px; padding: 10px; border-radius: 15px; transition: 0.3s; }
        .tower-row.active { background: rgba(255,153,0,0.05); border: 1px solid rgba(255,153,0,0.2); }

        /* RPS DISPLAY */
        .rps-move { font-size: 100px; transition: 0.5s; }
        .rps-win { color: var(--green); animation: pulse 1s infinite; }
        @keyframes pulse { 0% { scale: 1; } 50% { scale: 1.1; } 100% { scale: 1; } }

        .hidden { display: none !important; }
    </style>
</head>
<body onclick="initAudioContext()">

<div id="auth-screen" style="display:flex; justify-content:center; align-items:center; width: 100vw; height: 100vh; background: #050505; position:fixed; z-index: 9999;">
    <div style="width: 380px; text-align: center; background:var(--panel); padding:50px; border-radius:30px; border: 1px solid #333; box-shadow: 0 20px 60px rgba(0,0,0,0.7);">
        <div style="font-size: 40px; margin-bottom: 10px;">üêù</div>
        <h1 style="color:var(--orange); margin:0; font-size: 36px; font-weight: 900; letter-spacing: 3px;">SWARMBET</h1>
        <p style="color:#555; font-size:13px; margin-bottom:40px; font-weight: 600;">OFFICIAL PREMIUM CLIENT v2.6</p>
        
        <div style="text-align: left; margin-bottom: 20px;">
            <label style="color:#888; font-size:11px; font-weight:900; margin-left:5px;">U≈ΩIVATELSK√â JM√âNO</label>
            <input type="text" id="user" placeholder="Zadejte jm√©no..." style="width:100%; box-sizing: border-box; margin-top:5px;">
        </div>
        
        <div style="text-align: left; margin-bottom: 30px;">
            <label style="color:#888; font-size:11px; font-weight:900; margin-left:5px;">HESLO</label>
            <input type="password" id="pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="width:100%; box-sizing: border-box; margin-top:5px;">
        </div>

        <button class="btn-play" onclick="handleAuth('login')" style="width:100%; margin-bottom:15px; height: 55px;">P≈òIHL√ÅSIT SE</button>
        <div style="color:#444; margin-bottom: 15px;">nebo</div>
        <button class="btn-play" onclick="handleAuth('reg')" style="width:100%; background:#222; color:white; height: 55px;">VYTVO≈òIT √öƒåET</button>
    </div>
</div>

<div id="main-app" class="hidden" style="display: flex; width: 100%;">
    
    <div class="sidebar">
        <div class="logo">SWARM<span>BET</span></div>
        <div class="nav-item active" id="nav-games" onclick="switchTab('games')">üéÆ HLAVN√ç NAB√çDKA</div>
        <div class="nav-item" id="nav-history" onclick="switchTab('history')">üìú MOJE S√ÅZKY</div>
        <div class="nav-item" id="nav-promo" onclick="switchTab('promo')">üéÅ BONUSY & K√ìDY</div>
        <div class="nav-item" id="nav-stats" onclick="switchTab('stats')">üìä STATISTIKY</div>
        <div id="admin-link" class="nav-item hidden" onclick="switchTab('admin')" style="color:#e74c3c">‚öôÔ∏è ADMIN PANEL</div>
        
        <div class="sidebar-footer">
            <div class="nav-item" onclick="handleLogout()" style="padding: 10px 15px; border: 1px solid #333; border-radius: 10px;">üö™ ODHL√ÅSIT SE</div>
        </div>
    </div>

    <div class="main-wrapper">
        <div class="top-nav">
            <div id="server-status" style="margin-right: auto; color:#27ae60; font-size:12px; font-weight:bold; display:flex; align-items:center; gap:8px;">
                <span style="width:8px; height:8px; background:#27ae60; border-radius:50%; display:inline-block; animation: blink 2s infinite;"></span> SERVER ONLINE
            </div>
            <div class="balance-box">
                <span style="color:var(--orange); font-size: 20px;">‚≠ê</span>
                <span id="user-balance">0</span>
            </div>
            <div id="user-tag" style="background:var(--orange); color:black; padding:8px 15px; border-radius:8px; font-weight:900; font-size:14px;">PLAYER</div>
        </div>

        <div class="container">
            
            <div id="tab-games">
                <div id="games-menu" class="games-grid">
                    <div class="game-card" onclick="openGame('mines')">
                        <div class="icon-box" style="color:#e91e63;">üí£</div>
                        <h3 style="margin:0; font-size:22px;">MINES</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Hledej hvƒõzdy, vyh√Ωbej se bomb√°m.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('roulette')">
                        <div class="icon-box" style="color:#1abc9c;">üîò</div>
                        <h3 style="margin:0; font-size:22px;">ROULETTE</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Klasick√° evropsk√° ruleta s 36 ƒç√≠sly.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('blackjack')">
                        <div class="icon-box" style="color:#f39c12;">üÉè</div>
                        <h3 style="margin:0; font-size:22px;">BLACKJACK</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Pora≈æ dealera a tref 21.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('crash')">
                        <div class="icon-box" style="color:#2ecc71;">üöÄ</div>
                        <h3 style="margin:0; font-size:22px;">CRASH</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Vyskoƒç vƒças, ne≈æ raketa vybuchne.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('dice')">
                        <div class="icon-box" style="color:#3498db;">DICE</div>
                        <h3 style="margin:0; font-size:22px;">DICE ROLL</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Nastav si ≈°anci a hoƒè kostkou.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('coinflip')">
                        <div class="icon-box" style="color:var(--gold);">ü™ô</div>
                        <h3 style="margin:0; font-size:22px;">COINFLIP</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Pades√°t na pades√°t. Hlava nebo orel.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('limbo')">
                        <div class="icon-box" style="color:#e67e22;">üõ∏</div>
                        <h3 style="margin:0; font-size:22px;">LIMBO</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Tref n√°sobitel a zn√°sob s√°zku.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('baccarat')">
                        <div class="icon-box" style="color:#9b59b6;">üßß</div>
                        <h3 style="margin:0; font-size:22px;">BACCARAT</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Hr√°ƒç, Bank√©≈ô nebo Rem√≠za?</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('tower')">
                        <div class="icon-box" style="color:#f1c40f;">üè∞</div>
                        <h3 style="margin:0; font-size:22px;">TOWER</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">Vystoupej a≈æ na vrchol vƒõ≈æe.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                    <div class="game-card" onclick="openGame('rps')">
                        <div class="icon-box" style="color:white;">‚úä</div>
                        <h3 style="margin:0; font-size:22px;">RPS</h3>
                        <p style="color:#555; font-size:12px; margin:10px 0 25px;">K√°men, n≈Ø≈æky, pap√≠r proti botovi.</p>
                        <button class="btn-play">HR√ÅT TEƒé</button>
                    </div>
                </div>

                <div id="game-container" class="hidden">
                    <button class="btn-back" onclick="closeGame()">‚Üê ZPƒöT DO NAB√çDKY</button>
                    
                    <div style="background:var(--panel); padding:60px; border-radius:35px; border: 1px solid #222; box-shadow: 0 30px 100px rgba(0,0,0,0.5);">
                        
                        <div id="view-mines" class="hidden">
                            <h2 style="font-size:32px; margin-bottom:10px;">MINES</h2>
                            <div style="color:#666; margin-bottom:30px;">Poƒçet bomb: 3 | Multiplier: <span id="m-mult-display" style="color:var(--orange)">1.00x</span></div>
                            <div class="m-grid" id="m-board"></div>
                            <div style="display:flex; justify-content:center; gap:15px; margin-top:30px;">
                                <input type="number" id="m-bet-input" value="100">
                                <button class="btn-play" id="m-btn-start" onclick="minesStart()">S√ÅZKA</button>
                                <button class="btn-play hidden" id="m-btn-cash" onclick="minesCashout()" style="background:var(--green);">VYBRAT</button>
                            </div>
                        </div>

                        <div id="view-roulette" class="hidden">
                            <h2 style="margin-bottom:30px;">EUROPEAN ROULETTE</h2>
                            <div class="r-slider-wrap">
                                <div style="position:absolute; left:50%; width:4px; height:100%; background:white; z-index:100; transform:translateX(-50%); box-shadow:0 0 15px rgba(255,255,255,0.5);"></div>
                                <div id="r-slider" class="r-slider-inner"></div>
                            </div>
                            <div class="r-grid" id="r-board"></div>
                            <div style="display:flex; justify-content:center; gap:20px; align-items:center; margin-top:30px;">
                                <div>S√°zka: <input type="number" id="r-bet-input" value="50"></div>
                                <button class="btn-play" id="r-btn-spin" onclick="rouletteSpin()">ROZTOƒåIT</button>
                                <button class="btn-play" style="background:#333; color:white;" onclick="rouletteClear()">SMAZAT S√ÅZKY</button>
                            </div>
                        </div>

                        <div id="view-blackjack" class="hidden">
                            <div style="display:flex; justify-content:space-around; margin-bottom:40px;">
                                <div style="text-align:center;">
                                    <div class="hand-label">Dealerovy karty (<span id="bj-d-score">0</span>)</div>
                                    <div id="bj-dealer-cards" style="display:flex; gap:15px; min-height:130px;"></div>
                                </div>
                                <div style="text-align:center;">
                                    <div class="hand-label">Tvoje karty (<span id="bj-p-score">0</span>)</div>
                                    <div id="bj-player-cards" style="display:flex; gap:15px; min-height:130px;"></div>
                                </div>
                            </div>
                            <div style="display:flex; justify-content:center; gap:15px;">
                                <input type="number" id="bj-bet-input" value="100">
                                <button class="btn-play" id="bj-btn-deal" onclick="bjStart()">ROZDAT</button>
                                <button class="btn-play hidden" id="bj-btn-hit" onclick="bjHit()" style="background:var(--blue); color:white;">HIT</button>
                                <button class="btn-play hidden" id="bj-btn-stand" onclick="bjStand()" style="background:var(--purple); color:white;">STAND</button>
                            </div>
                        </div>

                        <div id="view-crash" class="hidden">
                            <h2 style="color:var(--green)">CRASH ROCKET</h2>
                            <div id="crash-display" style="margin:60px 0; color:var(--orange);">1.00x</div>
                            <div style="display:flex; justify-content:center; gap:15px;">
                                <input type="number" id="c-bet-input" value="100">
                                <button class="btn-play" id="c-btn-start" onclick="crashStart()">START</button>
                                <button class="btn-play hidden" id="c-btn-cash" onclick="crashCashout()" style="background:var(--green);">CASH OUT</button>
                            </div>
                        </div>

                        <div id="view-rps" class="hidden">
                            <h2 style="margin-bottom:40px;">K√ÅMEN N≈Æ≈ΩKY PAP√çR</h2>
                            <div style="display:flex; justify-content:center; gap:80px; align-items:center; margin-bottom:50px;">
                                <div style="text-align:center;">
                                    <div style="font-size:12px; color:#555; margin-bottom:10px;">TY</div>
                                    <div id="rps-user-move" class="rps-move">‚ùì</div>
                                </div>
                                <div style="font-size:40px; font-weight:900; color:#222;">VS</div>
                                <div style="text-align:center;">
                                    <div style="font-size:12px; color:#555; margin-bottom:10px;">BOT</div>
                                    <div id="rps-bot-move" class="rps-move">‚ùì</div>
                                </div>
                            </div>
                            <div id="rps-status" style="height:30px; font-weight:bold; color:var(--orange); margin-bottom:30px;">VYBER SI POHYB</div>
                            <div style="display:flex; justify-content:center; gap:15px; margin-bottom:30px;">
                                <button class="btn-play" onclick="rpsPlay('rock')" style="background:#444; color:white;">K√ÅMEN</button>
                                <button class="btn-play" onclick="rpsPlay('paper')" style="background:#444; color:white;">PAP√çR</button>
                                <button class="btn-play" onclick="rpsPlay('scissors')" style="background:#444; color:white;">N≈Æ≈ΩKY</button>
                            </div>
                            S√°zka: <input type="number" id="rps-bet-input" value="100">
                        </div>

                        <div id="view-tower" class="hidden">
                            <h2 style="margin-bottom:30px; color:var(--gold);">TOWER OF FORTUNE</h2>
                            <div id="tower-grid" style="display:flex; flex-direction:column-reverse; gap:10px; align-items:center;"></div>
                            <div style="display:flex; justify-content:center; gap:15px; margin-top:30px;">
                                <input type="number" id="t-bet-input" value="100">
                                <button class="btn-play" id="t-btn-start" onclick="towerStart()">ZAƒå√çT ≈†PLHAT</button>
                                <button class="btn-play hidden" id="t-btn-cash" onclick="towerCashout()" style="background:var(--green);">VYBRAT ZISK</button>
                            </div>
                        </div>

                        <div id="view-baccarat" class="hidden">
                            <h2 style="color:var(--purple)">BACCARAT PRO</h2>
                            <div style="display:flex; justify-content:center; gap:60px; margin:40px 0;">
                                <div style="text-align:center;">
                                    <div class="hand-label">HR√Åƒå (<span id="bac-p-score">0</span>)</div>
                                    <div id="bac-p-cards" style="display:flex; gap:10px; min-height:130px;"></div>
                                </div>
                                <div style="text-align:center;">
                                    <div class="hand-label">BANK√â≈ò (<span id="bac-b-score">0</span>)</div>
                                    <div id="bac-b-cards" style="display:flex; gap:10px; min-height:130px;"></div>
                                </div>
                            </div>
                            <div style="margin-bottom:20px;">S√°zka: <input type="number" id="bac-bet-input" value="100"></div>
                            <div style="display:flex; justify-content:center; gap:15px;">
                                <button class="btn-play" onclick="baccaratPlay('P')" style="background:var(--blue); color:white;">HR√Åƒå (2x)</button>
                                <button class="btn-play" onclick="baccaratPlay('T')" style="background:#777; color:white;">REM√çZA (9x)</button>
                                <button class="btn-play" onclick="baccaratPlay('B')" style="background:var(--red); color:white;">BANK√â≈ò (1.95x)</button>
                            </div>
                        </div>

                        <div id="view-generic" class="hidden">
                            <h2 id="gen-title">GAME</h2>
                            <div id="gen-display" style="font-size:100px; margin:50px;">üé≤</div>
                            <div id="gen-controls"></div>
                            <div style="margin-top:30px;">
                                S√°zka: <input type="number" id="gen-bet-input" value="100">
                                <button class="btn-play" id="gen-btn" onclick="genericPlay()">HODIT / VSADIT</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div id="tab-history" class="hidden">
                <div style="background:var(--panel); padding:40px; border-radius:25px; border: 1px solid #222;">
                    <h2 style="color:var(--orange)">HISTORIE VA≈†ICH S√ÅZEK</h2>
                    <table style="width:100%; text-align:left; border-collapse:collapse; margin-top:30px;">
                        <thead>
                            <tr style="color:#555; border-bottom:2px solid #222;">
                                <th style="padding:15px;">DATUM A ƒåAS</th>
                                <th>HRA</th>
                                <th>S√ÅZKA</th>
                                <th>N√ÅSOBITEL</th>
                                <th>V√ùSLEDEK</th>
                            </tr>
                        </thead>
                        <tbody id="history-table"></tbody>
                    </table>
                </div>
            </div>

            <div id="tab-promo" class="hidden">
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:30px;">
                    <div style="background:var(--panel); padding:50px; border-radius:25px; border:1px solid #222; text-align:center;">
                        <h2 style="color:var(--orange)">AKTIVOVAT PROMO K√ìD</h2>
                        <p style="color:#666; margin-bottom:30px;">Zadejte k√≥d a z√≠skejte okam≈æit√© Stars na v√°≈° √∫ƒçet.</p>
                        <input type="text" id="promo-code-input" placeholder="NAP≈ò. SWARM2026" style="width:100%; box-sizing:border-box; margin-bottom:20px; text-transform:uppercase;">
                        <button class="btn-play" onclick="promoRedeem()" style="width:100%;">AKTIVOVAT K√ìD</button>
                    </div>
                    <div style="background:var(--panel); padding:50px; border-radius:25px; border:1px solid #222;">
                        <h2 style="color:var(--gold)">DENN√ç ODMƒöNA</h2>
                        <p style="color:#666; margin-bottom:30px;">Ka≈æd√Ωch 24 hodin si m≈Ø≈æete vybrat 100 Stars zdarma.</p>
                        <button class="btn-play" id="daily-btn" onclick="dailyClaim()" style="width:100%; background:var(--gold);">VYBRAT 100 ‚≠ê</button>
                    </div>
                </div>
            </div>

            <div id="tab-admin" class="hidden">
                <div style="background:var(--panel); padding:40px; border-radius:25px; border: 1px solid #e74c3c;">
                    <h2 style="color:#e74c3c">ADMINISTR√ÅTORSK√â ROZHRAN√ç</h2>
                    <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:20px; margin-top:30px;">
                        <div style="background:#0c0c0c; padding:25px; border-radius:15px; border:1px solid #222;">
                            <h4 style="margin-top:0;">MANIPULACE S BALANCEM</h4>
                            <input type="text" id="adm-user" placeholder="U≈æivatel" style="width:100%; margin-bottom:10px;">
                            <input type="number" id="adm-amount" placeholder="ƒå√°stka (+/-)" style="width:100%; margin-bottom:15px;">
                            <button class="btn-play" onclick="adminUpdateBalance()" style="width:100%; background:#e74c3c; color:white;">AKTUALIZOVAT</button>
                        </div>
                        <div style="background:#0c0c0c; padding:25px; border-radius:15px; border:1px solid #222;">
                            <h4 style="margin-top:0;">GENEROVAT PROMO K√ìD</h4>
                            <input type="text" id="adm-promo-name" placeholder="N√°zev k√≥du" style="width:100%; margin-bottom:10px;">
                            <input type="number" id="adm-promo-val" placeholder="Hodnota Stars" style="width:100%; margin-bottom:15px;">
                            <button class="btn-play" onclick="adminCreatePromo()" style="width:100%; background:var(--green); color:white;">VYTVO≈òIT K√ìD</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<div id="win-overlay" class="win-announcement hidden"></div>

<script>
    /* =========================================
       SWARMBET CORE CONFIGURATION
       =========================================
    */
    const DB_URL = "https://casbss-c75a0-default-rtdb.europe-west1.firebasedatabase.app";
    let currentUser = null;
    let userData = null;
    let betHistory = [];
    let audioCtx = null;

    // --- SYSTEM CORE ---
    function initAudioContext() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }

    function playSound(freq, type, duration) {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type || 'sine';
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }

    // --- AUTHENTICATION ---
    async function handleAuth(mode) {
        const u = document.getElementById('user').value.trim();
        const p = document.getElementById('pass').value;
        if (!u || p.length < 4) return alert("Neplatn√© √∫daje!");

        try {
            const res = await fetch(`${DB_URL}/users/${u}.json`);
            const data = await res.json();

            if (mode === 'login') {
                if (data && data.password === p) {
                    currentUser = u;
                    userData = data;
                    authSuccess();
                } else alert("≈†patn√© jm√©no nebo heslo!");
            } else {
                if (data) return alert("U≈æivatel ji≈æ existuje!");
                const newUser = { password: p, chips: 1000, rank: 'Player', created: Date.now() };
                await fetch(`${DB_URL}/users/${u}.json`, { method: 'PUT', body: JSON.stringify(newUser) });
                alert("Registrace √∫spƒõ≈°n√°!");
            }
        } catch (e) { alert("Chyba serveru!"); }
    }

    function authSuccess() {
        document.getElementById('auth-screen').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
        document.getElementById('user-tag').innerText = userData.rank || 'PLAYER';
        
        const admins = ["sepiak", "artur", "admin", "SEPIAK"];
        if (admins.includes(currentUser.toLowerCase())) document.getElementById('admin-link').classList.remove('hidden');
        
        buildRouletteBoard();
        updateBalanceUI();
        playSound(440, 'sine', 0.2);
    }

    function updateBalanceUI() {
        document.getElementById('user-balance').innerText = Math.floor(userData.chips).toLocaleString();
        fetch(`${DB_URL}/users/${currentUser}/chips.json`, { method: 'PUT', body: userData.chips });
    }

    function switchTab(tab) {
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById('nav-' + tab).classList.add('active');
        
        ['games', 'history', 'promo', 'stats', 'admin'].forEach(t => {
            const el = document.getElementById('tab-' + t);
            if(el) el.classList.add('hidden');
        });
        document.getElementById('tab-' + tab).classList.remove('hidden');
        
        if (tab === 'history') renderHistory();
    }

    // --- GAME ENGINE ---
    let activeGame = null;

    function openGame(game) {
        activeGame = game;
        document.getElementById('games-menu').classList.add('hidden');
        document.getElementById('game-container').classList.remove('hidden');
        
        const views = ['mines','roulette','blackjack','crash','rps','tower','baccarat','generic'];
        views.forEach(v => document.getElementById('view-' + v).classList.add('hidden'));
        
        if (['dice', 'coinflip', 'limbo'].includes(game)) {
            setupGenericGame(game);
            document.getElementById('view-generic').classList.remove('hidden');
        } else {
            document.getElementById('view-' + game).classList.remove('hidden');
            if(game === 'tower') initTower();
        }
    }

    function closeGame() {
        if(crashActive) crashStop();
        document.getElementById('games-menu').classList.remove('hidden');
        document.getElementById('game-container').classList.add('hidden');
        activeGame = null;
    }

    function showWin(mult, amount) {
        const overlay = document.getElementById('win-overlay');
        overlay.innerHTML = `<div class="win-inner"><h1 style="color:var(--gold); font-size:90px; margin:0;">${mult.toFixed(2)}x</h1><h2 style="color:white; margin:0;">+${Math.floor(amount).toLocaleString()} ‚≠ê</h2></div>`;
        overlay.classList.remove('hidden');
        playSound(600, 'sine', 0.5);
        setTimeout(() => overlay.classList.add('hidden'), 3000);
    }

    function addBetHistory(game, bet, mult, win) {
        const entry = {
            time: new Date().toLocaleTimeString(),
            game: game.toUpperCase(),
            bet: bet,
            mult: mult,
            win: Math.floor(win)
        };
        betHistory.unshift(entry);
        if (betHistory.length > 20) betHistory.pop();
    }

    function renderHistory() {
        const tbody = document.getElementById('history-table');
        tbody.innerHTML = betHistory.map(h => `
            <tr style="border-bottom: 1px solid #1a1a1a;">
                <td style="padding:15px; color:#555;">${h.time}</td>
                <td style="font-weight:bold;">${h.game}</td>
                <td>${h.bet} ‚≠ê</td>
                <td style="color:var(--orange)">${h.mult.toFixed(2)}x</td>
                <td style="font-weight:900; color:${h.win > 0 ? 'var(--green)' : 'var(--red)'}">${h.win > 0 ? '+' + h.win : h.win}</td>
            </tr>
        `).join('');
    }

    /* =========================================
       GAMES LOGIC IMPLEMENTATION
       =========================================
    */

    // --- MINES ---
    let minesActive = false, minesMult = 1.0, minesBet = 0, minesBombs = [];
    function minesStart() {
        minesBet = parseInt(document.getElementById('m-bet-input').value);
        if (minesBet > userData.chips || minesBet <= 0) return alert("Nedostatek Stars!");
        
        userData.chips -= minesBet;
        updateBalanceUI();
        minesActive = true;
        minesMult = 1.0;
        minesBombs = [];
        
        while(minesBombs.length < 3) {
            let r = Math.floor(Math.random() * 25);
            if(!minesBombs.includes(r)) minesBombs.push(r);
        }

        document.getElementById('m-btn-start').disabled = true;
        document.getElementById('m-btn-cash').classList.add('hidden');
        document.getElementById('m-mult-display').innerText = "1.00x";
        
        const board = document.getElementById('m-board');
        board.innerHTML = '';
        for(let i=0; i<25; i++) {
            const t = document.createElement('div');
            t.className = 'tile';
            t.onclick = () => minesTileClick(i, t);
            board.appendChild(t);
        }
    }

    function minesTileClick(idx, el) {
        if(!minesActive || el.classList.contains('revealed')) return;
        el.classList.add('revealed');
        
        if(minesBombs.includes(idx)) {
            el.innerHTML = 'üí•';
            el.style.background = 'var(--red)';
            minesActive = false;
            addBetHistory("Mines", minesBet, 0, -minesBet);
            document.getElementById('m-btn-start').disabled = false;
            document.getElementById('m-btn-cash').classList.add('hidden');
            playSound(150, 'sawtooth', 0.4);
        } else {
            el.innerHTML = '‚≠ê';
            el.style.color = 'var(--gold)';
            minesMult *= 1.35;
            document.getElementById('m-mult-display').innerText = minesMult.toFixed(2) + "x";
            document.getElementById('m-btn-cash').classList.remove('hidden');
            playSound(800, 'sine', 0.1);
        }
    }

    function minesCashout() {
        if(!minesActive) return;
        const win = minesBet * minesMult;
        userData.chips += win;
        showWin(minesMult, win);
        addBetHistory("Mines", minesBet, minesMult, win);
        minesActive = false;
        updateBalanceUI();
        document.getElementById('m-btn-start').disabled = false;
        document.getElementById('m-btn-cash').classList.add('hidden');
    }

    // --- ROULETTE ---
    const rOrder = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];
    const rReds = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
    let rBets = {}, rSpinning = false;

    function buildRouletteBoard() {
        const slider = document.getElementById('r-slider');
        let html = "";
        for(let i=0; i<20; i++) {
            rOrder.forEach(n => {
                let color = n === 0 ? 'var(--green)' : (rReds.includes(n) ? 'var(--red)' : 'var(--black)');
                html += `<div class="r-num" style="background:${color}">${n}</div>`;
            });
        }
        slider.innerHTML = html;

        const board = document.getElementById('r-board');
        let bHtml = `<div class="cell nula" onclick="rPlaceBet('n0', this)">0</div>`;
        for(let col=1; col<=12; col++) {
            for(let row=3; row>=1; row--) {
                let n = (col-1)*3 + row;
                let color = rReds.includes(n) ? 'var(--red)' : 'var(--black)';
                bHtml += `<div class="cell" style="background:${color}" onclick="rPlaceBet('n${n}', this)">${n}</div>`;
            }
        }
        board.innerHTML = bHtml;
    }

    function rPlaceBet(type, el) {
        if(rSpinning) return;
        let amt = parseInt(document.getElementById('r-bet-input').value);
        if(amt > userData.chips) return;

        if(!rBets[type]) rBets[type] = 0;
        rBets[type] += amt;
        userData.chips -= amt;
        updateBalanceUI();

        let chip = el.querySelector('.chip-overlay');
        if(!chip) {
            chip = document.createElement('div');
            chip.className = 'chip-overlay';
            el.appendChild(chip);
        }
        chip.innerText = rBets[type];
        el.classList.add('active');
        playSound(500, 'sine', 0.05);
    }

    function rouletteClear() {
        if(rSpinning) return;
        for(let k in rBets) userData.chips += rBets[k];
        rBets = {};
        document.querySelectorAll('.cell').forEach(c => {
            c.classList.remove('active');
            const chip = c.querySelector('.chip-overlay');
            if(chip) chip.remove();
        });
        updateBalanceUI();
    }

    function rouletteSpin() {
        if(rSpinning || Object.keys(rBets).length === 0) return;
        rSpinning = true;
        document.getElementById('r-btn-spin').disabled = true;

        const winIdx = Math.floor(Math.random() * rOrder.length);
        const winNum = rOrder[winIdx];
        const itemWidth = 90;
        const totalItems = rOrder.length * 20;
        const offset = ((10 * rOrder.length) + winIdx) * itemWidth;
        const center = document.querySelector('.r-slider-wrap').offsetWidth / 2 - (itemWidth/2);
        
        document.getElementById('r-slider').style.transform = `translateX(${-offset + center}px)`;

        setTimeout(() => {
            let totalWin = 0;
            let totalBet = 0;
            for(let b in rBets) {
                totalBet += rBets[b];
                if(b === 'n'+winNum) totalWin += rBets[b] * 36;
            }

            if(totalWin > 0) {
                userData.chips += totalWin;
                showWin(totalWin/totalBet, totalWin);
                addBetHistory("Roulette", totalBet, totalWin/totalBet, totalWin);
            } else {
                addBetHistory("Roulette", totalBet, 0, -totalBet);
            }

            rSpinning = false;
            document.getElementById('r-btn-spin').disabled = false;
            updateBalanceUI();
            rouletteClear();
        }, 5500);
    }

    // --- BLACKJACK ---
    let bjDeck = [], bjPHand = [], bjDHand = [], bjBet = 0, bjActive = false;

    function createDeck() {
        const suits = ['‚ô†','‚ô£','‚ô•','‚ô¶'], vals = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
        bjDeck = [];
        for(let s of suits) for(let v of vals) bjDeck.push({v, s, color: (s==='‚ô•'||s==='‚ô¶'?'red':'black')});
        bjDeck.sort(() => Math.random() - 0.5);
    }

    function getHandScore(h) {
        let s = 0, a = 0;
        h.forEach(c => {
            if(c.v === 'A') a++;
            else if(['J','Q','K'].includes(c.v)) s += 10;
            else s += parseInt(c.v);
        });
        for(let i=0; i<a; i++) s += (s + 11 <= 21) ? 11 : 1;
        return s;
    }

    function renderBJCard(c, target) {
        const div = document.createElement('div');
        div.className = `card-ui ${c.color}`;
        div.innerHTML = `<div>${c.v}</div><div style="font-size:30px; align-self:center;">${c.s}</div><div style="align-self:flex-end;">${c.v}</div>`;
        document.getElementById(target).appendChild(div);
    }

    function bjStart() {
        bjBet = parseInt(document.getElementById('bj-bet-input').value);
        if(bjBet > userData.chips) return alert("M√°lo Stars!");
        
        userData.chips -= bjBet;
        updateBalanceUI();
        createDeck();
        bjPHand = [bjDeck.pop(), bjDeck.pop()];
        bjDHand = [bjDeck.pop(), bjDeck.pop()];
        bjActive = true;

        document.getElementById('bj-player-cards').innerHTML = '';
        document.getElementById('bj-dealer-cards').innerHTML = '';
        bjPHand.forEach(c => renderBJCard(c, 'bj-player-cards'));
        renderBJCard(bjDHand[0], 'bj-dealer-cards');

        document.getElementById('bj-p-score').innerText = getHandScore(bjPHand);
        document.getElementById('bj-d-score').innerText = "?";

        document.getElementById('bj-btn-deal').classList.add('hidden');
        document.getElementById('bj-btn-hit').classList.remove('hidden');
        document.getElementById('bj-btn-stand').classList.remove('hidden');
    }

    function bjHit() {
        if(!bjActive) return;
        let c = bjDeck.pop();
        bjPHand.push(c);
        renderBJCard(c, 'bj-player-cards');
        let s = getHandScore(bjPHand);
        document.getElementById('bj-p-score').innerText = s;
        if(s > 21) bjStand();
    }

    function bjStand() {
        bjActive = false;
        document.getElementById('bj-dealer-cards').innerHTML = '';
        bjDHand.forEach(c => renderBJCard(c, 'bj-dealer-cards'));
        
        let ds = getHandScore(bjDHand);
        while(ds < 17) {
            let c = bjDeck.pop();
            bjDHand.push(c);
            renderBJCard(c, 'bj-dealer-cards');
            ds = getHandScore(bjDHand);
        }
        document.getElementById('bj-d-score').innerText = ds;

        let ps = getHandScore(bjPHand);
        if(ps <= 21 && (ds > 21 || ps > ds)) {
            let win = bjBet * 2;
            userData.chips += win;
            showWin(2, win);
            addBetHistory("Blackjack", bjBet, 2, win);
        } else if (ps <= 21 && ps === ds) {
            userData.chips += bjBet;
            alert("Rem√≠za!");
        } else {
            addBetHistory("Blackjack", bjBet, 0, -bjBet);
        }

        updateBalanceUI();
        document.getElementById('bj-btn-deal').classList.remove('hidden');
        document.getElementById('bj-btn-hit').classList.add('hidden');
        document.getElementById('bj-btn-stand').classList.add('hidden');
    }

    // --- CRASH ---
    let crashActive = false, crashMult = 1.0, crashInterval, crashBet = 0;
    function crashStart() {
        crashBet = parseInt(document.getElementById('c-bet-input').value);
        if(crashBet > userData.chips || crashBet <= 0) return;
        
        userData.chips -= crashBet;
        updateBalanceUI();
        crashActive = true;
        crashMult = 1.00;
        
        document.getElementById('c-btn-start').disabled = true;
        document.getElementById('c-btn-cash').classList.remove('hidden');
        document.getElementById('crash-display').style.color = "var(--orange)";

        let boom = (Math.random() < 0.06) ? 1.00 : (0.98 / (1 - Math.random()));
        
        crashInterval = setInterval(() => {
            crashMult += 0.01 * (crashMult / 2);
            document.getElementById('crash-display').innerText = crashMult.toFixed(2) + "x";
            
            if(crashMult >= boom) {
                crashStop();
                document.getElementById('crash-display').style.color = "var(--red)";
                addBetHistory("Crash", crashBet, 0, -crashBet);
                playSound(100, 'square', 0.5);
            }
        }, 80);
    }

    function crashCashout() {
        if(!crashActive) return;
        clearInterval(crashInterval);
        crashActive = false;
        let win = crashBet * crashMult;
        userData.chips += win;
        showWin(crashMult, win);
        addBetHistory("Crash", crashBet, crashMult, win);
        updateBalanceUI();
        document.getElementById('c-btn-start').disabled = false;
        document.getElementById('c-btn-cash').classList.add('hidden');
    }

    function crashStop() {
        clearInterval(crashInterval);
        crashActive = false;
        document.getElementById('c-btn-start').disabled = false;
        document.getElementById('c-btn-cash').classList.add('hidden');
        updateBalanceUI();
    }

    // --- RPS ---
    function rpsPlay(uMove) {
        let bet = parseInt(document.getElementById('rps-bet-input').value);
        if(bet > userData.chips) return alert("M√°lo Stars!");
        
        userData.chips -= bet;
        const moves = ['rock', 'paper', 'scissors'];
        const emojis = {rock:'‚úä', paper:'‚úã', scissors:'‚úåÔ∏è'};
        const bMove = moves[Math.floor(Math.random() * 3)];

        document.getElementById('rps-user-move').innerText = emojis[uMove];
        document.getElementById('rps-bot-move').innerText = emojis[bMove];

        let result = "";
        if(uMove === bMove) {
            result = "REM√çZA!";
            userData.chips += bet;
        } else if (
            (uMove === 'rock' && bMove === 'scissors') ||
            (uMove === 'paper' && bMove === 'rock') ||
            (uMove === 'scissors' && bMove === 'paper')
        ) {
            result = "VYHR√ÅL JSI!";
            let win = bet * 2;
            userData.chips += win;
            showWin(2, win);
            addBetHistory("RPS", bet, 2, win);
        } else {
            result = "PROHR√ÅL JSI!";
            addBetHistory("RPS", bet, 0, -bet);
        }

        document.getElementById('rps-status').innerText = result;
        updateBalanceUI();
    }

    // --- TOWER ---
    let tLevel = 0, tActive = false, tBet = 0;
    const tMults = [1.2, 1.6, 2.1, 3.0, 4.5, 7.0, 12.0, 25.0];

    function initTower() {
        const grid = document.getElementById('tower-grid');
        grid.innerHTML = '';
        for(let i=0; i<8; i++) {
            const row = document.createElement('div');
            row.className = 'tower-row';
            row.id = `t-row-${i}`;
            for(let j=0; j<3; j++) {
                const b = document.createElement('div');
                b.className = 'tile';
                b.onclick = () => towerStep(i, j);
                row.appendChild(b);
            }
            grid.appendChild(row);
        }
    }

    function towerStart() {
        tBet = parseInt(document.getElementById('t-bet-input').value);
        if(tBet > userData.chips) return;
        userData.chips -= tBet;
        updateBalanceUI();
        tLevel = 0;
        tActive = true;
        initTower();
        document.getElementById('t-row-0').classList.add('active');
        document.getElementById('t-btn-start').disabled = true;
    }

    function towerStep(row, col) {
        if(!tActive || row !== tLevel) return;
        const correct = Math.floor(Math.random() * 3);
        const tiles = document.getElementById(`t-row-${row}`).children;
        
        if(col !== correct) {
            tiles[col].innerHTML = 'üí•';
            tActive = false;
            addBetHistory("Tower", tBet, 0, -tBet);
            document.getElementById('t-btn-start').disabled = false;
            document.getElementById('t-btn-cash').classList.add('hidden');
        } else {
            tiles[col].innerHTML = '‚≠ê';
            document.getElementById(`t-row-${tLevel}`).classList.remove('active');
            tLevel++;
            if(tLevel === 8) towerCashout();
            else {
                document.getElementById(`t-row-${tLevel}`).classList.add('active');
                document.getElementById('t-btn-cash').classList.remove('hidden');
                playSound(600 + (tLevel * 50), 'sine', 0.1);
            }
        }
    }

    function towerCashout() {
        if(!tActive) return;
        let win = tBet * tMults[tLevel-1];
        userData.chips += win;
        showWin(tMults[tLevel-1], win);
        addBetHistory("Tower", tBet, tMults[tLevel-1], win);
        tActive = false;
        updateBalanceUI();
        document.getElementById('t-btn-start').disabled = false;
        document.getElementById('t-btn-cash').classList.add('hidden');
    }

    // --- BACCARAT ---
    function baccaratPlay(choice) {
        let bet = parseInt(document.getElementById('bac-bet-input').value);
        if(bet > userData.chips) return;
        userData.chips -= bet;
        updateBalanceUI();
        createDeck();

        let pHand = [bjDeck.pop(), bjDeck.pop()];
        let bHand = [bjDeck.pop(), bjDeck.pop()];

        const getBacScore = (h) => {
            let s = 0;
            h.forEach(c => {
                if(['J','Q','K','10'].includes(c.v)) s += 0;
                else if(c.v === 'A') s += 1;
                else s += parseInt(c.v);
            });
            return s % 10;
        };

        document.getElementById('bac-p-cards').innerHTML = '';
        document.getElementById('bac-b-cards').innerHTML = '';
        pHand.forEach(c => renderBJCard(c, 'bac-p-cards'));
        bHand.forEach(c => renderBJCard(c, 'bac-b-cards'));

        let ps = getBacScore(pHand);
        let bs = getBacScore(bHand);
        document.getElementById('bac-p-score').innerText = ps;
        document.getElementById('bac-b-score').innerText = bs;

        let winner = ps > bs ? 'P' : (bs > ps ? 'B' : 'T');
        if(choice === winner) {
            let mult = winner === 'T' ? 9 : (winner === 'P' ? 2 : 1.95);
            let win = bet * mult;
            userData.chips += win;
            showWin(mult, win);
            addBetHistory("Baccarat", bet, mult, win);
        } else {
            addBetHistory("Baccarat", bet, 0, -bet);
        }
        updateBalanceUI();
    }

    // --- GENERIC GAMES (DICE, COIN, LIMBO) ---
    function setupGenericGame(g) {
        const title = document.getElementById('gen-title');
        const display = document.getElementById('gen-display');
        const controls = document.getElementById('gen-controls');
        controls.innerHTML = '';

        if(g === 'dice') {
            title.innerText = "DICE ROLL";
            display.innerText = "üé≤";
            controls.innerHTML = 'Tipni si ƒç√≠slo (1-6): <input type="number" id="dice-val" value="1" min="1" max="6" style="width:60px;">';
        } else if (g === 'coinflip') {
            title.innerText = "COINFLIP";
            display.innerText = "ü™ô";
            controls.innerHTML = 'Strana: <select id="coin-val" style="padding:10px; background:#000; color:var(--orange); border-radius:8px;"><option value="H">HLAVA</option><option value="O">OREL</option></select>';
        } else if (g === 'limbo') {
            title.innerText = "LIMBO";
            display.innerText = "1.00x";
            controls.innerHTML = 'Target Multiplier: <input type="number" id="limbo-val" value="2.00" step="0.1" style="width:100px;">';
        }
    }

    function genericPlay() {
        let bet = parseInt(document.getElementById('gen-bet-input').value);
        if(bet > userData.chips) return;
        userData.chips -= bet;
        updateBalanceUI();

        if(activeGame === 'dice') {
            let tip = parseInt(document.getElementById('dice-val').value);
            let res = Math.floor(Math.random() * 6) + 1;
            document.getElementById('gen-display').innerText = res;
            if(tip === res) {
                userData.chips += bet * 6;
                showWin(6, bet * 6);
                addBetHistory("Dice", bet, 6, bet*6);
            } else addBetHistory("Dice", bet, 0, -bet);
        } else if (activeGame === 'coinflip') {
            let tip = document.getElementById('coin-val').value;
            let res = Math.random() > 0.5 ? 'H' : 'O';
            document.getElementById('gen-display').innerText = res === 'H' ? 'ü™ô (H)' : 'ü™ô (O)';
            if(tip === res) {
                userData.chips += bet * 2;
                showWin(2, bet * 2);
                addBetHistory("Coinflip", bet, 2, bet*2);
            } else addBetHistory("Coinflip", bet, 0, -bet);
        } else if (activeGame === 'limbo') {
            let target = parseFloat(document.getElementById('limbo-val').value);
            let crash = 0.98 / (1 - Math.random());
            document.getElementById('gen-display').innerText = crash.toFixed(2) + "x";
            if(crash >= target) {
                let win = bet * target;
                userData.chips += win;
                showWin(target, win);
                addBetHistory("Limbo", bet, target, win);
            } else addBetHistory("Limbo", bet, 0, -bet);
        }
        updateBalanceUI();
    }

    // --- PROMO & ADMIN ---
    async function promoRedeem() {
        const code = document.getElementById('promo-code-input').value.trim().toUpperCase();
        if(!code) return;
        const res = await fetch(`${DB_URL}/promos/${code}.json`);
        const val = await res.json();
        if(val) {
            userData.chips += val;
            updateBalanceUI();
            alert(`K√≥d p≈ôijat! Z√≠sk√°no ${val} Stars.`);
            await fetch(`${DB_URL}/promos/${code}.json`, { method: 'DELETE' });
        } else alert("Neplatn√Ω nebo pou≈æit√Ω k√≥d.");
    }

    async function adminUpdateBalance() {
        const target = document.getElementById('adm-user').value.trim();
        const amt = parseInt(document.getElementById('adm-amount').value);
        if(!target || isNaN(amt)) return;
        const res = await fetch(`${DB_URL}/users/${target}.json`);
        let data = await res.json();
        if(data) {
            data.chips += amt;
            await fetch(`${DB_URL}/users/${target}.json`, { method: 'PUT', body: JSON.stringify(data) });
            alert("Balance aktualizov√°n.");
        }
    }

    async function adminCreatePromo() {
        const name = document.getElementById('adm-promo-name').value.trim().toUpperCase();
        const val = parseInt(document.getElementById('adm-promo-val').value);
        if(!name || isNaN(val)) return;
        await fetch(`${DB_URL}/promos/${name}.json`, { method: 'PUT', body: JSON.stringify(val) });
        alert("Promo vytvo≈ôeno.");
    }

    function handleLogout() {
        localStorage.removeItem('swarm_user');
        location.reload();
    }
</script>
</body>
</html>
