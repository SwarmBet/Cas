<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SwarmBet - Star Premium 2026</title>
    <style>
        :root { 
            --orange: #ff9900; --dark: #0a0a0a; --panel: #151515; --green: #27ae60; 
            --red: #e74c3c; --black: #2c3e50; --gold: #f1c40f; --sidebar: #111111;
            --transition-speed: 0.3s;
        }

        body { 
            background-color: var(--dark); color: white; 
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif; 
            margin: 0; display: flex; height: 100vh; overflow: hidden;
            background-image: radial-gradient(circle at center, rgba(255, 153, 0, 0.03) 0%, transparent 80%);
        }

        /* SIDEBAR NAVIGATION */
        .sidebar { width: 240px; background: var(--sidebar); border-right: 1px solid #222; display: flex; flex-direction: column; padding: 20px 0; flex-shrink: 0; z-index: 1000; }
        .logo { padding: 0 25px 30px; font-size: 28px; font-weight: 900; color: white; text-decoration: none; letter-spacing: -1px; }
        .logo span { color: var(--orange); }
        .nav-item { padding: 15px 25px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 12px; transition: var(--transition-speed); color: #888; border-left: 3px solid transparent; }
        .nav-item:hover { background: rgba(255, 153, 0, 0.05); color: #ccc; }
        .nav-item.active { background: rgba(255, 153, 0, 0.1); color: var(--orange); border-left: 3px solid var(--orange); }

        .main-wrapper { flex: 1; display: flex; flex-direction: column; overflow-y: auto; position: relative; }
        .top-nav { height: 70px; background: #000; border-bottom: 2px solid var(--orange); display: flex; align-items: center; justify-content: flex-end; padding: 0 40px; gap: 20px; position: sticky; top: 0; z-index: 100; }
        .balance-box { background: #1a1a1a; padding: 10px 20px; border-radius: 10px; color: white; font-weight: 800; display: flex; align-items: center; gap: 12px; border: 1px solid #333; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .display-name-text { font-weight: 900; color: var(--orange); text-transform: uppercase; font-size: 14px; }

        .container { padding: 40px; max-width: 1200px; margin: 0 auto; width: 100%; box-sizing: border-box; }
        .card { background: var(--panel); border: 1px solid #222; border-radius: 20px; padding: 30px; box-shadow: 0 15px 40px rgba(0,0,0,0.6); }
        .hidden { display: none !important; }
        .btn-play { background: var(--orange); color: black; border: none; padding: 14px 24px; border-radius: 10px; font-weight: 900; cursor: pointer; transition: 0.1s; text-transform: uppercase; }
        .btn-back { background: #222; color: #888; border: 1px solid #333; padding: 10px 18px; border-radius: 8px; cursor: pointer; margin-bottom: 25px; font-weight: bold; }
        input, select { background: #000; border: 1px solid #333; color: var(--orange); padding: 12px; border-radius: 10px; text-align: center; outline: none; font-weight: bold; font-family: inherit; }

        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .game-card { background: #111; border-radius: 18px; padding: 30px 20px; text-align: center; transition: 0.3s; cursor: pointer; border: 1px solid #222; position: relative; }
        .game-card:hover { transform: translateY(-8px); border-color: var(--orange); }
        .icon-box { width: 60px; height: 60px; background: rgba(0,0,0,0.5); border-radius: 15px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 32px; }

        /* Win Overlay */
        .win-announcement { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 9999; text-align: center; animation: winPop 3s forwards; pointer-events: none; }
        @keyframes winPop { 0% { opacity:0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity:1; transform: translate(-50%, -50%) scale(1.1); } 100% { opacity:0; transform: translate(-50%, -70%) scale(0.8); } }
        
        /* Grid and Table Styles */
        .m-grid { display: grid; grid-template-columns: repeat(5, 65px); gap: 12px; justify-content: center; margin-top: 30px; }
        .tile { width: 65px; height: 65px; background: #000; border: 1px solid #333; border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 32px; }
        table { width: 100%; border-collapse: collapse; margin-top: 30px; }
        th { text-align: left; color: #555; padding: 15px; border-bottom: 2px solid #222; }
        td { padding: 20px 15px; border-bottom: 1px solid #1a1a1a; }
    </style>
</head>
<body onclick="initAudio()">

    <div id="auth-screen" style="display:flex; justify-content:center; align-items:center; width: 100vw; height: 100vh; background: var(--dark); position:fixed; z-index: 2000;">
        <div class="card" style="width: 360px; text-align: center; border: 2px solid var(--orange);">
            <h1 style="color:var(--orange); margin:0;">SWARMBET</h1>
            <p style="color:#444; font-size:12px; margin-bottom:30px;">PREMIUM SYSTEM 2026</p>
            <input type="text" id="user" placeholder="USERNAME" style="width:85%; margin-bottom:15px;"><br>
            <input type="password" id="pass" placeholder="PASSWORD" style="width:85%; margin-bottom:25px;"><br>
            <button class="btn-play" onclick="auth('login')" style="width:95%; margin-bottom:12px;">LOGIN SYSTEM</button>
            <button class="btn-play" onclick="auth('reg')" style="width:95%; background:#1a1a1a; color:#888;">REGISTER ACCOUNT</button>
            <p id="auth-msg" style="color: var(--red); font-size: 12px; margin-top: 15px;"></p>
        </div>
    </div>

    <div id="main-app" class="hidden" style="display: flex; width: 100%;">
        <div class="sidebar">
            <div class="logo">SWARM<span>BET</span></div>
            <div class="nav-item active" onclick="showPage('games')">üéÆ Explorer Games</div>
            <div class="nav-item" onclick="showPage('history')">üìú Live History</div>
            <div style="margin-top: auto; padding: 20px;"><div class="nav-item" onclick="logout()">üö™ Terminate Session</div></div>
        </div>

        <div class="main-wrapper">
            <div class="top-nav">
                <div class="balance-box"><span style="color:var(--orange);">‚≠ê</span> <span id="display-chips">0</span></div>
                <div class="display-name-text" id="display-name">---</div>
            </div>

            <div class="container">
                <div id="page-games">
                    <div id="selection-menu">
                        <div class="games-grid">
                            <div class="game-card" onclick="selectGame('mines')">
                                <div class="icon-box" style="color:#e91e63;">üí£</div>
                                <h3>Mines</h3><p>Avoid Bombs</p>
                            </div>
                            <div class="game-card" onclick="selectGame('dice')">
                                <div class="icon-box" style="color:#3498db;">üé≤</div>
                                <h3>Dice</h3><p>Roll 1-6</p>
                            </div>
                            <div class="game-card" onclick="selectGame('tower')">
                                <div class="icon-box" style="color:#f1c40f;">üè∞</div>
                                <h3>Tower</h3><p>The Climb</p>
                            </div>
                        </div>
                    </div>

                    <div id="game-active-page" class="hidden">
                        <button class="btn-back" onclick="backToMenu()">‚Üê BACK TO LIBRARY</button>
                        <div class="card" id="game-mines" class="hidden">
                            <h2 style="text-align:center; color:#e91e63;">MINES</h2>
                            <div style="text-align:center; margin-bottom:20px;">
                                BET: <input type="number" id="m-bet" value="50" style="width:100px;">
                                <button class="btn-play" id="m-start" onclick="startMines()">START</button>
                                <button id="m-cash" class="hidden btn-play" style="background:#2ecc71;" onclick="cashoutMines()">CASH OUT</button>
                            </div>
                            <div class="m-grid" id="m-board"></div>
                        </div>
                        
                        <div class="card hidden" id="game-dice" style="text-align:center;">
                            <h2 style="color:#3498db;">DICE ROLL</h2>
                            <div id="d-res" style="font-size:100px; margin:30px;">üé≤</div>
                            GUESS: <input type="number" id="d-num" value="1" min="1" max="6" style="width:60px;">
                            BET: <input type="number" id="d-bet" value="50" style="width:100px;">
                            <button class="btn-play" onclick="playDice()">ROLL</button>
                        </div>

                        <div class="card hidden" id="game-tower" style="text-align:center;">
                            <h2 style="color:#f1c40f;">THE TOWER</h2>
                            <div id="tower-board" style="display:flex; flex-direction:column-reverse; gap:8px; align-items:center; margin-bottom:20px;"></div>
                            BET: <input type="number" id="t-bet" value="50" style="width:100px;">
                            <button class="btn-play" id="t-start" onclick="startTower()">START</button>
                            <button id="t-cash" class="hidden btn-play" style="background:#2ecc71;" onclick="cashoutTower()">CASH OUT</button>
                        </div>
                    </div>
                </div>

                <div id="page-history" class="hidden">
                    <div class="card"><h2>GLOBAL HISTORY</h2><table><tbody id="history-body"></tbody></table></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const DB_URL = "https://casbss-c75a0-default-rtdb.europe-west1.firebasedatabase.app/users";
        let currentUser = localStorage.getItem('swarm_user');
        let userData = { chips: 0, history: [] };

        // --- AUTH & SYSTEM ---
        async function auth(type) {
            const u = document.getElementById('user').value.trim();
            const p = document.getElementById('pass').value;
            if(!u || !p) return;
            try {
                const res = await fetch(`${DB_URL}/${u}.json`);
                const data = await res.json();
                if(type === 'reg') {
                    if(data) { document.getElementById('auth-msg').innerText = "USERNAME TAKEN"; return; }
                    await fetch(`${DB_URL}/${u}.json`, { method: 'PUT', body: JSON.stringify({password:p, chips:500, history:[]}) });
                    document.getElementById('auth-msg').style.color = "var(--green)";
                    document.getElementById('auth-msg').innerText = "REGISTERED! NOW LOGIN.";
                } else {
                    if(data && data.password === p) {
                        currentUser = u; userData = data;
                        localStorage.setItem('swarm_user', u);
                        loginSuccess();
                    } else document.getElementById('auth-msg').innerText = "INVALID CREDENTIALS";
                }
            } catch(e) { console.error(e); }
        }

        function loginSuccess() {
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            document.getElementById('display-name').innerText = currentUser;
            updateUI();
        }

        function logout() { localStorage.removeItem('swarm_user'); location.reload(); }

        function updateUI() {
            if(!userData) return;
            document.getElementById('display-chips').innerText = Math.floor(userData.chips);
            fetch(`${DB_URL}/${currentUser}.json`, { method: 'PUT', body: JSON.stringify(userData) });
            renderHistory();
        }

        function showPage(p) {
            document.getElementById('page-games').classList.add('hidden');
            document.getElementById('page-history').classList.add('hidden');
            document.getElementById('page-'+p).classList.remove('hidden');
        }

        function selectGame(g) {
            document.getElementById('selection-menu').classList.add('hidden');
            document.getElementById('game-active-page').classList.remove('hidden');
            document.getElementById('game-mines').classList.add('hidden');
            document.getElementById('game-dice').classList.add('hidden');
            document.getElementById('game-tower').classList.add('hidden');
            document.getElementById('game-'+g).classList.remove('hidden');
        }

        function backToMenu() { document.getElementById('selection-menu').classList.remove('hidden'); document.getElementById('game-active-page').classList.add('hidden'); }

        function showWinOverlay(m, amt) {
            const div = document.createElement('div'); div.className = 'win-announcement';
            div.innerHTML = `<h1 style="color:var(--gold); font-size:80px;">${m.toFixed(2)}x</h1><h2 style="color:white;">+${Math.floor(amt)} ‚≠ê</h2>`;
            document.body.appendChild(div); setTimeout(() => div.remove(), 3000);
        }

        function addHistory(game, bet, mult, payout) {
            if(!userData.history) userData.history = [];
            userData.history.unshift({game, bet, mult, payout, time: new Date().toLocaleTimeString()});
            if(userData.history.length > 15) userData.history.pop();
            updateUI();
        }

        function renderHistory() {
            const body = document.getElementById('history-body');
            body.innerHTML = userData.history ? userData.history.map(h => `<tr><td>${h.game}</td><td>${h.bet}</td><td>${h.mult}x</td><td class="${h.payout>0?'status-win':'status-loss'}">${h.payout}</td></tr>`).join('') : '';
        }

        // --- GAMES LOGIC ---
        // Mines
        let mActive = false, mBet = 0, mMult = 1, mBombs = [];
        function startMines() {
            mBet = parseInt(document.getElementById('m-bet').value);
            if(mBet > userData.chips || mBet <= 0) return;
            userData.chips -= mBet; mActive = true; mMult = 1; mBombs = [];
            document.getElementById('m-start').disabled = true;
            document.getElementById('m-cash').classList.add('hidden');
            const board = document.getElementById('m-board'); board.innerHTML = '';
            while(mBombs.length < 3) { let r = Math.floor(Math.random()*25); if(!mBombs.includes(r)) mBombs.push(r); }
            for(let i=0; i<25; i++) {
                let t = document.createElement('div'); t.className = 'tile';
                t.onclick = () => {
                    if(!mActive || t.innerText !== "") return;
                    if(mBombs.includes(i)) {
                        t.innerText = 'üí•'; mActive = false; document.getElementById('m-start').disabled = false;
                        addHistory("Mines", mBet, 0, -mBet);
                    } else {
                        t.innerText = '‚≠ê'; mMult *= 1.25; document.getElementById('m-cash').classList.remove('hidden');
                    }
                };
                board.appendChild(t);
            }
            updateUI();
        }

        function cashoutMines() {
            if(!mActive) return;
            let win = mBet * mMult; userData.chips += win; mActive = false;
            document.getElementById('m-start').disabled = false;
            document.getElementById('m-cash').classList.add('hidden');
            showWinOverlay(mMult, win); addHistory("Mines", mBet, mMult, win);
            updateUI();
        }

        // Dice
        function playDice() {
            let b = parseInt(document.getElementById('d-bet').value);
            let n = parseInt(document.getElementById('d-num').value);
            if(b > userData.chips || b <= 0) return;
            userData.chips -= b;
            let r = Math.floor(Math.random()*6)+1;
            document.getElementById('d-res').innerText = r;
            if(r === n) { userData.chips += (b * 6); showWinOverlay(6, b*6); addHistory("Dice", b, 6, b*6); }
            else { addHistory("Dice", b, 0, -b); }
            updateUI();
        }

        // Tower
        let tLevel = 0, tActive = false, tBet = 0;
        const tMults = [1.5, 2.5, 4.5, 8, 15, 30];
        function startTower() {
            tBet = parseInt(document.getElementById('t-bet').value);
            if(tBet > userData.chips || tBet <= 0) return;
            userData.chips -= tBet; tActive = true; tLevel = 0;
            document.getElementById('t-start').disabled = true;
            const board = document.getElementById('tower-board'); board.innerHTML = '';
            for(let i=0; i<6; i++) {
                const row = document.createElement('div'); row.style.display = 'flex'; row.style.gap = '5px';
                for(let j=0; j<3; j++) {
                    const t = document.createElement('div'); t.style.width = '60px'; t.style.height = '30px'; t.style.background = '#222'; t.style.borderRadius = '4px'; t.style.cursor = 'pointer';
                    t.onclick = () => {
                        if(!tActive || i !== tLevel) return;
                        if(Math.random() > 0.4) {
                            t.style.background = 'var(--green)'; tLevel++; 
                            document.getElementById('t-cash').classList.remove('hidden');
                            if(tLevel === 6) cashoutTower();
                        } else {
                            t.style.background = 'var(--red)'; tActive = false; document.getElementById('t-start').disabled = false;
                            addHistory("Tower", tBet, 0, -tBet);
                        }
                    };
                    row.appendChild(t);
                }
                board.appendChild(row);
            }
            updateUI();
        }

        function cashoutTower() {
            if(!tActive || tLevel === 0) return;
            let m = tMults[tLevel-1]; let win = tBet * m;
            userData.chips += win; tActive = false;
            document.getElementById('t-start').disabled = false;
            document.getElementById('t-cash').classList.add('hidden');
            showWinOverlay(m, win); addHistory("Tower", tBet, m, win);
            updateUI();
        }

        function initAudio() {}
        window.onload = () => { if(currentUser) auth('login'); };
    </script>
</body>
</html>
