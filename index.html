<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Skibidi Online Casino</title>
    <style>
        :root { --gold: #d4af37; --bg: #0f0f0f; --card: #1a1a1a; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; justify-content: center; }
        .container { width: 500px; background: var(--card); border: 3px solid var(--gold); border-radius: 20px; padding: 20px; margin: 20px; box-shadow: 0 0 30px rgba(0,0,0,1); }
        
        /* Menu */
        .nav { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin: 15px 0; }
        button { background: #333; color: white; border: 1px solid var(--gold); padding: 8px; border-radius: 5px; cursor: pointer; font-size: 12px; transition: 0.2s; }
        button:hover { background: var(--gold); color: black; }
        button.active { background: var(--gold); color: black; font-weight: bold; }

        /* Hry */
        .game-section { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; min-height: 250px; text-align: center; }
        .hidden { display: none !important; }
        
        /* Mines Grid */
        .mines-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin: 15px auto; width: 250px; }
        .mine-tile { width: 45px; height: 45px; background: #444; border-radius: 5px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .mine-tile.revealed { background: #222; cursor: default; }
        .mine-tile.gem { background: #27ae60; animation: pop 0.3s; }
        .mine-tile.bomb { background: #e74c3c; animation: shake 0.3s; }

        /* Blackjack & Cards */
        .hand { display: flex; justify-content: center; gap: 5px; margin: 10px 0; height: 80px; }
        .card { width: 50px; height: 75px; background: white; color: black; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-weight: bold; animation: slideIn 0.3s; }

        @keyframes pop { 0% {transform: scale(0.5);} 100% {transform: scale(1);} }
        @keyframes slideIn { from {transform: translateY(-20px); opacity: 0;} }
        @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-5px);} 75% {transform: translateX(5px);} }

        input { background: #000; color: var(--gold); border: 1px solid var(--gold); padding: 8px; border-radius: 5px; width: 80px; text-align: center; }
        #admin-panel { border: 1px dashed red; margin-top: 20px; padding: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div id="auth-ui">
        <h2 style="text-align:center; color:var(--gold);">GOLDEN STAKE ONLINE</h2>
        <input type="text" id="user" placeholder="Jm√©no" style="width:90%"><br>
        <input type="password" id="pass" placeholder="Heslo" style="width:90%"><br><br>
        <button onclick="auth('login')" style="width:45%">Login</button>
        <button onclick="auth('reg')" style="width:45%">Registrovat</button>
    </div>

    <div id="game-ui" class="hidden">
        <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #444;">
            <b id="display-name"></b>
            <span style="font-size:20px; color:var(--gold);">üí∞ <span id="display-chips">0</span></span>
        </div>

        <div class="nav">
            <button onclick="tab('bj')">Blackjack</button>
            <button onclick="tab('dice')">Dice</button>
            <button onclick="tab('roulette')">Ruleta</button>
            <button onclick="tab('baccarat')">Baccarat</button>
            <button onclick="tab('mines')">Mines</button>
            <button onclick="logout()" style="color:red">Odhl√°sit</button>
        </div>

        <div id="status" style="color:var(--gold); text-align:center; font-weight:bold; height:20px; margin:10px;"></div>

        <div id="sec-mines" class="game-section hidden">
            Miny: <input type="number" id="mine-count" value="3" min="1" max="24">
            S√°zka: <input type="number" id="mine-bet" value="10">
            <button onclick="startMines()">Hr√°t Miny</button>
            <div class="mines-grid" id="mines-board"></div>
            <button id="mines-cashout" class="hidden" onclick="cashoutMines()" style="background:green">VYBRAT</button>
        </div>

        <div id="sec-bj" class="game-section hidden">
            S√°zka: <input type="number" id="bj-bet" value="10">
            <button onclick="startBJ()" id="bj-btn-start">Rozdat</button>
            <div id="bj-play" class="hidden">
                <p>Dealer: <div id="d-hand" class="hand"></div></p>
                <p>Ty: <div id="p-hand" class="hand"></div></p>
                <button onclick="bjAction('hit')">HIT</button>
                <button onclick="bjAction('stand')">STAND</button>
            </div>
        </div>

        <div id="sec-dice" class="game-section hidden">
            <h3>Kostky (Dice)</h3>
            Vsaƒè na (1-6): <input type="number" id="dice-num" min="1" max="6" value="1">
            S√°zka: <input type="number" id="dice-bet" value="10">
            <button onclick="playDice()">Hodit kostkou</button>
            <h1 id="dice-result">?</h1>
        </div>

        <div id="sec-roulette" class="game-section hidden">V p≈ô√≠pravƒõ... (Zkuste Mines!)</div>
        <div id="sec-baccarat" class="game-section hidden">V p≈ô√≠pravƒõ... (Zkuste Mines!)</div>

        <div id="admin-panel" class="hidden">
            <small>Admin Console</small><br>
            <input type="text" id="admin-cmd" placeholder="/give jm√©no ƒç√°stka" style="width:90%" onkeypress="adminKey(event)">
        </div>
    </div>
</div>

<script>
    const DB_URL = "https://casbss-c75a0-default-rtdb.europe-west1.firebasedatabase.app/users";
    let currentUser = null;
    let userData = null;

    // --- SYST√âM ---
    async function auth(type) {
        const u = document.getElementById('user').value.trim();
        const p = document.getElementById('pass').value;
        if(!u || !p) return;
        const res = await fetch(DB_URL + ".json");
        const users = await res.json() || {};

        if(type === 'reg') {
            if(users[u]) return alert("Jm√©no obsazeno!");
            userData = { password: p, chips: 100 };
            await fetch(`${DB_URL}/${u}.json`, { method: 'PUT', body: JSON.stringify(userData) });
            alert("Registrov√°n! P≈ôihlas se.");
        } else {
            if(users[u] && users[u].password === p) {
                currentUser = u; userData = users[u];
                document.getElementById('auth-ui').classList.add('hidden');
                document.getElementById('game-ui').classList.remove('hidden');
                document.getElementById('display-name').innerText = u;
                if(u === "skibiditoilet") document.getElementById('admin-panel').classList.remove('hidden');
                updateUI();
            } else alert("≈†patn√© √∫daje!");
        }
    }

    async function updateUI() {
        document.getElementById('display-chips').innerText = userData.chips;
        await fetch(`${DB_URL}/${currentUser}.json`, { method: 'PUT', body: JSON.stringify(userData) });
    }

    function tab(name) {
        document.querySelectorAll('.game-section').forEach(s => s.classList.add('hidden'));
        document.getElementById('sec-' + name).classList.remove('hidden');
        document.getElementById('status').innerText = "";
    }

    function logout() { location.reload(); }

    // --- MINES LOGIC ---
    let minesActive = false, mineMultiplier = 1, currentMines = [], revealedCount = 0, currentMineBet = 0;
    function startMines() {
        let b = parseInt(document.getElementById('mine-bet').value);
        let count = parseInt(document.getElementById('mine-count').value);
        if(b > userData.chips || b <= 0) return;
        
        userData.chips -= b; currentMineBet = b; updateUI();
        minesActive = true; revealedCount = 0; mineMultiplier = 1;
        document.getElementById('mines-board').innerHTML = '';
        document.getElementById('mines-cashout').classList.remove('hidden');
        
        currentMines = new Array(25).fill(false);
        let placed = 0;
        while(placed < count) {
            let r = Math.floor(Math.random()*25);
            if(!currentMines[r]) { currentMines[r] = true; placed++; }
        }

        for(let i=0; i<25; i++) {
            let tile = document.createElement('div');
            tile.className = 'mine-tile';
            tile.onclick = () => clickTile(i, tile);
            document.getElementById('mines-board').appendChild(tile);
        }
    }

    function clickTile(idx, el) {
        if(!minesActive || el.classList.contains('revealed')) return;
        el.classList.add('revealed');
        if(currentMines[idx]) {
            el.innerHTML = 'üí£'; el.classList.add('bomb');
            minesActive = false; document.getElementById('status').innerText = "BOOM! Prohra.";
            document.getElementById('mines-cashout').classList.add('hidden');
        } else {
            el.innerHTML = 'üíé'; el.classList.add('gem');
            revealedCount++;
            let mineCount = parseInt(document.getElementById('mine-count').value);
            mineMultiplier *= (1 + (mineCount / (25 - revealedCount)));
            document.getElementById('status').innerText = `N√°sobitel: ${mineMultiplier.toFixed(2)}x`;
        }
    }

    function cashoutMines() {
        if(!minesActive || revealedCount === 0) return;
        let win = Math.floor(currentMineBet * mineMultiplier);
        userData.chips += win;
        document.getElementById('status').innerText = `Vyhr√°l jsi ${win}!`;
        minesActive = false; updateUI();
        document.getElementById('mines-cashout').classList.add('hidden');
    }

    // --- DICE LOGIC ---
    function playDice() {
        let b = parseInt(document.getElementById('dice-bet').value);
        let n = parseInt(document.getElementById('dice-num').value);
        if(b > userData.chips) return;
        userData.chips -= b;
        let res = Math.floor(Math.random()*6)+1;
        document.getElementById('dice-result').innerText = res;
        if(res === n) {
            userData.chips += b * 6; document.getElementById('status').innerText = "V√ùHRA!";
        } else document.getElementById('status').innerText = "PROHRA";
        updateUI();
    }

    // --- BLACKJACK LOGIC ---
    let pHand = [], dHand = [], bjBet = 0, deck = [];
    function startBJ() {
        bjBet = parseInt(document.getElementById('bj-bet').value);
        if(bjBet > userData.chips) return;
        userData.chips -= bjBet; updateUI();
        document.getElementById('bj-btn-start').classList.add('hidden');
        document.getElementById('bj-play').classList.remove('hidden');
        deck = []; ['‚ô†','‚ô•','‚ô¶','‚ô£'].forEach(s => ['2','3','4','5','6','7','8','9','10','J','Q','K','A'].forEach(v => deck.push({v,s})));
        deck.sort(() => Math.random()-0.5);
        pHand = [deck.pop(), deck.pop()]; dHand = [deck.pop(), deck.pop()];
        renderBJ(false);
    }
    function renderBJ(all) {
        const p = document.getElementById('p-hand'), d = document.getElementById('d-hand');
        p.innerHTML = ''; d.innerHTML = '';
        pHand.forEach(c => p.innerHTML += `<div class="card">${c.v}${c.s}</div>`);
        dHand.forEach((c,i) => d.innerHTML += `<div class="card" style="${!all && i===1 ? 'background:#333':''}">${!all && i===1 ? '':c.v+c.s}</div>`);
    }
    // (Zbytek BJ logiky je stejn√Ω jako d≈ô√≠ve...)

    // --- ADMIN ---
    async function adminKey(e) {
        if(e.key === 'Enter') {
            const p = e.target.value.split(' ');
            if(p[0] === '/give') {
                const res = await fetch(DB_URL + ".json");
                const users = await res.json();
                if(users[p[1]]) {
                    users[p[1]].chips += parseInt(p[2]);
                    await fetch(`${DB_URL}/${p[1]}.json`, { method: 'PUT', body: JSON.stringify(users[p[1]]) });
                    alert("D√°no!"); updateUI();
                }
            }
            e.target.value = '';
        }
    }
</script>
</body>
</html>
