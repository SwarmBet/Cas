<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SwarmBet - Star Premium 2026</title>
    <style>
        :root { 
            --orange: #ff9900; --dark: #0a0a0a; --panel: #151515; --accent: #2f354c;
            --green: #27ae60; --red: #e74c3c; --black: #2c3e50; --gold: #f1c40f; 
            --text-dim: #9299b8; --blue: #0084ff;
        }
        body { 
            background-color: var(--dark); color: white; font-family: 'Segoe UI', sans-serif; 
            margin: 0; display: flex; flex-direction: column; min-height: 100vh; 
            background-image: radial-gradient(circle at center, rgba(255, 153, 0, 0.03) 0%, transparent 80%); 
            overflow-x: hidden; 
        }

        /* Logo & Brand */
        .logo-nav { height: 45px; cursor: pointer; transition: 0.3s; vertical-align: middle; }
        .logo-nav:hover { transform: scale(1.05); filter: drop-shadow(0 0 10px var(--orange)); }
        .auth-logo { width: 140px; margin-bottom: 20px; filter: drop-shadow(0 0 15px rgba(255, 153, 0, 0.4)); animation: logoPulse 3s infinite ease-in-out; }
        @keyframes logoPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

        /* Navbar */
        .navbar { display: flex; justify-content: space-between; align-items: center; padding: 10px 40px; background: #000; border-bottom: 2px solid var(--orange); position: sticky; top: 0; z-index: 100; }
        .nav-links span { cursor: pointer; font-weight: bold; color: #888; margin-left: 20px; transition: 0.3s; }
        .nav-links span.active, .nav-links span:hover { color: var(--orange); }
        .user-section { position: relative; cursor: pointer; padding: 5px 10px; }
        .user-name { font-weight: 900; color: var(--orange); }

        /* Layout */
        .container { width: 1000px; margin: 30px auto; flex: 1; }
        .hidden { display: none !important; }
        .card { background: var(--panel); border: 1px solid #222; border-radius: 15px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        /* Game Layout (New Design) */
        .game-wrapper { display: grid; grid-template-columns: 280px 1fr; background: #111; border-radius: 12px; overflow: hidden; border: 1px solid #333; }
        .sidebar { background: #1a1a1a; padding: 20px; display: flex; flex-direction: column; gap: 15px; border-right: 1px solid #333; }
        .main-game-area { background: #0c0c0c; padding: 40px; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 500px; position: relative; }

        /* Inputs & Tabs */
        .input-group { background: #222; border-radius: 6px; padding: 10px; border: 1px solid #333; }
        .input-group label { display: block; font-size: 10px; color: var(--text-dim); text-transform: uppercase; font-weight: bold; margin-bottom: 5px; }
        .input-group input, .input-group select { background: transparent; border: none; color: white; width: 100%; outline: none; font-weight: bold; font-size: 14px; }
        
        /* Buttons */
        .btn-play { background: var(--orange); color: black; border: none; padding: 15px; border-radius: 6px; font-weight: 900; cursor: pointer; text-transform: uppercase; transition: 0.2s; }
        .btn-play:hover { filter: brightness(1.2); }
        .btn-cashout { background: #4a5474; color: white; border: none; padding: 15px; border-radius: 6px; font-weight: 900; cursor: pointer; }

        /* Mines Design */
        .mines-grid { display: grid; grid-template-columns: repeat(5, 70px); gap: 10px; }
        .tile { width: 70px; height: 70px; background: var(--accent); border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 30px; transition: 0.2s; }
        .tile.revealed { background: #070707; border: 2px solid var(--accent); cursor: default; }
        .tile.win { background: rgba(89, 172, 33, 0.2); border-color: var(--green); color: var(--green); }
        .tile.loss { background: rgba(231, 76, 60, 0.2); border-color: var(--red); color: var(--red); }

        /* Tower Design */
        .tower-grid { display: flex; flex-direction: column-reverse; gap: 8px; }
        .tower-row { display: grid; grid-template-columns: repeat(4, 60px); gap: 8px; opacity: 0.3; pointer-events: none; }
        .tower-row.active { opacity: 1; pointer-events: all; }
        .tower-tile { width: 60px; height: 45px; background: var(--accent); border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center; }

        /* Dice Design */
        .dice-display { font-size: 80px; font-weight: 900; margin-bottom: 20px; }
        .dice-slider { -webkit-appearance: none; width: 100%; height: 12px; background: linear-gradient(to right, var(--red) 50%, var(--green) 50%); border-radius: 10px; outline: none; }
        .dice-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 25px; height: 25px; background: white; border-radius: 5px; cursor: pointer; }

        /* Win Animation */
        .win-announcement { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 9999; text-align: center; pointer-events: none; animation: winPop 3s forwards; }
        .win-mult { font-size: 80px; font-weight: 900; color: var(--gold); }
        @keyframes winPop { 0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); } 100% { opacity: 0; transform: translate(-50%, -70%); } }

        /* Lobby Cards */
        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .game-card { background: #111; border-radius: 12px; padding: 25px; text-align: center; cursor: pointer; border: 1px solid #222; transition: 0.3s; }
        .game-card:hover { transform: translateY(-5px); border-color: var(--orange); }
    </style>
</head>
<body onclick="initAudio()">

<div id="auth-screen" style="display:flex; justify-content:center; align-items:center; height: 100vh; position: fixed; inset: 0; background: var(--dark); z-index: 9999;">
    <div class="card" style="width: 340px; text-align: center;">
        <img src="https://i.ibb.co/v6yXQzYt/ChatGPT-Image-20-2-2026-17-17-34-removebg-preview.png" class="auth-logo">
        <div class="input-group" style="margin-bottom: 10px;"><label>Username</label><input type="text" id="user" placeholder="Enter name"></div>
        <div class="input-group" style="margin-bottom: 20px;"><label>Password</label><input type="password" id="pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"></div>
        <button class="btn-play" onclick="auth('login')" style="width:100%;">Login / Play</button>
    </div>
</div>

<div id="main-app" class="hidden">
    <nav class="navbar">
        <div onclick="backToMenu()"><img src="https://i.ibb.co/v6yXQzYt/ChatGPT-Image-20-2-2026-17-17-34-removebg-preview.png" class="logo-nav"></div>
        <div class="user-section">
            <div class="user-info">
                <span class="user-name" id="display-name">---</span>
                <span style="font-size:14px; color:var(--gold);">‚≠ê <span id="display-chips">0</span></span>
            </div>
        </div>
    </nav>

    <div class="container">
        <div id="selection-menu">
            <h2 style="color: var(--text-dim); margin-bottom: 20px;">PREMIUM GAMES</h2>
            <div class="games-grid">
                <div class="game-card" onclick="selectGame('mines')"><div style="font-size:40px;">üí£</div><h3>Mines</h3><p>Avoid the bombs</p></div>
                <div class="game-card" onclick="selectGame('tower')"><div style="font-size:40px;">üè∞</div><h3>Tower</h3><p>Climb the castle</p></div>
                <div class="game-card" onclick="selectGame('dice')"><div style="font-size:40px;">üé≤</div><h3>Dice</h3><p>Predict the roll</p></div>
                <div class="game-card" onclick="selectGame('crash')"><div style="font-size:40px;">üöÄ</div><h3>Crash</h3><p>Cashout in time</p></div>
            </div>
        </div>

        <div id="game-active-page" class="hidden">
            <div class="game-wrapper">
                <div class="sidebar">
                    <div class="input-group"><label>Bet Amount</label><input type="number" id="global-bet" value="50"></div>
                    
                    <div id="side-mines" class="hidden">
                        <div class="input-group"><label>Mines Count</label>
                            <select id="m-count"><option value="1">1 Mine</option><option value="3" selected>3 Mines</option><option value="13">13 Mines</option><option value="24">24 Mines</option></select>
                        </div>
                    </div>

                    <button class="btn-play" id="main-bet-btn" onclick="startGame()">Place Bet</button>
                    <button class="btn-cashout hidden" id="main-cash-btn" onclick="cashoutGame()">Cashout</button>
                </div>

                <div class="main-game-area">
                    <div id="game-mines" class="hidden"><div class="mines-grid" id="m-board"></div></div>
                    
                    <div id="game-tower" class="hidden"><div class="tower-grid" id="t-board"></div></div>
                    
                    <div id="game-dice" class="hidden">
                        <div class="dice-display" id="d-res">50.00</div>
                        <input type="range" id="d-slider" class="dice-slider" min="2" max="98" value="50" oninput="updateDice()">
                        <div style="display:flex; justify-content: space-between; width: 100%; margin-top: 20px; color: var(--text-dim); font-size: 12px;">
                            <span>CHANCE: <b id="d-chance">49.50%</b></span>
                            <span>MULT: <b id="d-mult">2.00x</b></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="win-container"></div>

<script>
    const DB_URL = "https://casbss-c75a0-default-rtdb.europe-west1.firebasedatabase.app/users";
    let currentUser = null, userData = { chips: 5000 }, isPlaying = false, activeGame = '';

    // Audio SFX
    const sfx = { 
        win: "https://www.myinstants.com/media/sounds/correct_2.mp3",
        boom: "https://www.myinstants.com/media/sounds/explosion.mp3",
        click: "https://raw.githubusercontent.com/theking9x/Roblox-Sounds/main/UIPresentation.mp3"
    };
    function playSfx(n) { const a = new Audio(sfx[n]); a.volume = 0.2; a.play().catch(()=>{}); }
    function initAudio() {}

    // Auth
    async function auth(type) {
        currentUser = document.getElementById('user').value || 'Guest';
        document.getElementById('auth-screen').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
        document.getElementById('display-name').innerText = currentUser;
        updateUI();
    }

    function updateUI() {
        document.getElementById('display-chips').innerText = Math.floor(userData.chips);
    }

    function backToMenu() {
        document.getElementById('selection-menu').classList.remove('hidden');
        document.getElementById('game-active-page').classList.add('hidden');
        isPlaying = false;
    }

    function selectGame(g) {
        activeGame = g;
        document.getElementById('selection-menu').classList.add('hidden');
        document.getElementById('game-active-page').classList.remove('hidden');
        ['mines','tower','dice'].forEach(id => document.getElementById('game-'+id).classList.add('hidden'));
        ['side-mines'].forEach(id => document.getElementById(id).classList.add('hidden'));
        
        document.getElementById('game-'+g).classList.remove('hidden');
        if(document.getElementById('side-'+g)) document.getElementById('side-'+g).classList.remove('hidden');
        
        if(g === 'mines') initMines();
        if(g === 'tower') initTower();
        if(g === 'dice') updateDice();
    }

    function startGame() {
        let bet = parseInt(document.getElementById('global-bet').value);
        if(userData.chips < bet) return alert("Not enough chips!");
        
        userData.chips -= bet;
        updateUI();
        isPlaying = true;
        
        document.getElementById('main-bet-btn').classList.add('hidden');
        document.getElementById('main-cash-btn').classList.remove('hidden');

        if(activeGame === 'mines') setupMines();
        if(activeGame === 'tower') setupTower();
        if(activeGame === 'dice') playDice();
    }

    // --- MINES LOGIC ---
    let mBombs = [], mClicks = 0, mBet = 0;
    function initMines() {
        const b = document.getElementById('m-board'); b.innerHTML = '';
        for(let i=0; i<25; i++) {
            let t = document.createElement('div'); t.className = 'tile';
            t.onclick = () => clickMine(i, t);
            b.appendChild(t);
        }
    }
    function setupMines() {
        mClicks = 0; mBet = parseInt(document.getElementById('global-bet').value);
        let count = parseInt(document.getElementById('m-count').value);
        mBombs = [];
        while(mBombs.length < count) {
            let r = Math.floor(Math.random()*25);
            if(!mBombs.includes(r)) mBombs.push(r);
        }
        initMines();
    }
    function clickMine(i, el) {
        if(!isPlaying || el.classList.contains('revealed')) return;
        el.classList.add('revealed');
        if(mBombs.includes(i)) {
            el.innerHTML = 'üí£'; el.classList.add('loss'); playSfx('boom');
            isPlaying = false;
            setTimeout(() => selectGame('mines'), 1000);
            resetButtons();
        } else {
            el.innerHTML = 'üíé'; el.classList.add('win'); playSfx('click');
            mClicks++;
            // Calculate mult
            let mCount = parseInt(document.getElementById('m-count').value);
            let mult = getMinesMult(mCount, mClicks);
            document.getElementById('main-cash-btn').innerText = `Cashout (${(mBet * mult).toFixed(0)})`;
        }
    }
    function getMinesMult(m, c) {
        const combinations = (n, k) => {
            if (k > n) return 0;
            if (k === 0 || k === n) return 1;
            let res = 1;
            for (let i = 1; i <= k; i++) res = res * (n - i + 1) / i;
            return res;
        };
        let prob = combinations(25 - m, c) / combinations(25, c);
        return 0.98 / prob;
    }

    // --- TOWER LOGIC ---
    let tLevel = 0;
    function initTower() {
        const b = document.getElementById('t-board'); b.innerHTML = '';
        for(let i=0; i<8; i++) {
            let r = document.createElement('div'); r.className = 'tower-row'; r.id = 't-row-'+i;
            for(let j=0; j<4; j++) {
                let t = document.createElement('div'); t.className = 'tower-tile';
                t.onclick = () => clickTower(i, j, t);
                r.appendChild(t);
            }
            b.appendChild(r);
        }
    }
    function setupTower() {
        tLevel = 0; initTower();
        document.getElementById('t-row-0').classList.add('active');
    }
    function clickTower(row, col, el) {
        if(!isPlaying || row !== tLevel) return;
        let win = Math.random() > 0.3; // 75% chance
        if(win) {
            el.style.background = 'var(--green)'; el.innerHTML = 'üíé'; playSfx('click');
            document.getElementById('t-row-'+tLevel).classList.remove('active');
            tLevel++;
            if(tLevel < 8) document.getElementById('t-row-'+tLevel).classList.add('active');
            else cashoutGame();
        } else {
            el.style.background = 'var(--red)'; el.innerHTML = 'üí£'; playSfx('boom');
            isPlaying = false; resetButtons();
        }
    }

    // --- DICE LOGIC ---
    function updateDice() {
        let val = document.getElementById('d-slider').value;
        let chance = 100 - val;
        document.getElementById('d-chance').innerText = chance.toFixed(2) + "%";
        document.getElementById('d-mult').innerText = (99 / chance).toFixed(2) + "x";
    }
    function playDice() {
        let val = document.getElementById('d-slider').value;
        let roll = (Math.random() * 100).toFixed(2);
        document.getElementById('d-res').innerText = roll;
        if(roll > val) {
            let mult = 99 / (100 - val);
            let win = parseInt(document.getElementById('global-bet').value) * mult;
            userData.chips += win; playSfx('win'); showWinOverlay(mult, win);
        } else {
            playSfx('boom');
        }
        resetButtons(); updateUI();
    }

    function cashoutGame() {
        if(!isPlaying) return;
        let bet = parseInt(document.getElementById('global-bet').value);
        let win = 0;
        if(activeGame === 'mines') win = bet * getMinesMult(parseInt(document.getElementById('m-count').value), mClicks);
        if(activeGame === 'tower') win = bet * Math.pow(1.3, tLevel);
        
        userData.chips += win;
        playSfx('win');
        showWinOverlay(win/bet, win);
        isPlaying = false;
        resetButtons();
        updateUI();
    }

    function resetButtons() {
        document.getElementById('main-bet-btn').classList.remove('hidden');
        document.getElementById('main-cash-btn').classList.add('hidden');
        document.getElementById('main-cash-btn').innerText = "Cashout";
    }

    function showWinOverlay(mult, amt) {
        const div = document.createElement('div'); div.className = 'win-announcement';
        div.innerHTML = `<div class="win-mult">${mult.toFixed(2)}x</div><div style="font-size:30px">+${Math.floor(amt)} ‚≠ê</div>`;
        document.body.appendChild(div);
        setTimeout(() => div.remove(), 3000);
    }
</script>
</body>
</html>
